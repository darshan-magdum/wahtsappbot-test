"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.DirectLineStreaming = void 0;
var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));
var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));
var _classPrivateFieldGet2 = _interopRequireDefault(require("@babel/runtime/helpers/classPrivateFieldGet"));
var _classPrivateFieldSet2 = _interopRequireDefault(require("@babel/runtime/helpers/classPrivateFieldSet"));
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _BehaviorSubject = require("rxjs/BehaviorSubject");
var _buffer = require("buffer");
var _Observable = require("rxjs/Observable");
var BFSE = _interopRequireWildcard(require("botframework-streaming"));
var _createDeferred = _interopRequireDefault(require("./createDeferred"));
var _crossFetch = _interopRequireDefault(require("cross-fetch"));
var _directLine = require("./directLine");
var _WebSocketClientWithNetworkInformation = _interopRequireDefault(require("./streaming/WebSocketClientWithNetworkInformation"));
var _excluded = ["attachments"]; // In order to keep file size down, only import the parts of rxjs that we use
function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }
function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }
var DIRECT_LINE_VERSION = 'DirectLine/3.0';
var MAX_RETRY_COUNT = 3;
var refreshTokenLifetime = 30 * 60 * 1000;
//const refreshTokenLifetime = 5000;
// const timeout = 20 * 1000;
var refreshTokenInterval = refreshTokenLifetime / 2;
var StreamHandler = /*#__PURE__*/function () {
  function StreamHandler(s, c$, sq) {
    (0, _classCallCheck2["default"])(this, StreamHandler);
    (0, _defineProperty2["default"])(this, "activityQueue", []);
    this.subscriber = s;
    this.connectionStatus$ = c$;
    this.shouldQueue = sq;
  }
  (0, _createClass2["default"])(StreamHandler, [{
    key: "setSubscriber",
    value: function setSubscriber(s) {
      this.subscriber = s;
    }
  }, {
    key: "processRequest",
    value: function () {
      var _processRequest = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee(request, logger) {
        var streams, stream0, activitySetJson, activitySet, activity, attachments, stream, attachment, dataUri;
        return _regenerator["default"].wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                streams = (0, _toConsumableArray2["default"])(request.streams);
                stream0 = streams.shift();
                _context.next = 4;
                return stream0.readAsString();
              case 4:
                activitySetJson = _context.sent;
                activitySet = JSON.parse(activitySetJson);
                if (!(activitySet.activities.length !== 1)) {
                  _context.next = 9;
                  break;
                }
                // Only one activity is expected in a set in streaming
                this.subscriber.error(new Error('there should be exactly one activity'));
                return _context.abrupt("return", BFSE.StreamingResponse.create(500));
              case 9:
                activity = activitySet.activities[0];
                if (!(streams.length > 0)) {
                  _context.next = 21;
                  break;
                }
                attachments = (0, _toConsumableArray2["default"])(activity.attachments);
              case 12:
                if (!(stream = streams.shift())) {
                  _context.next = 20;
                  break;
                }
                _context.next = 15;
                return stream.readAsString();
              case 15:
                attachment = _context.sent;
                dataUri = 'data:text/plain;base64,' + attachment;
                attachments.push({
                  contentType: stream.contentType,
                  contentUrl: dataUri
                });
                _context.next = 12;
                break;
              case 20:
                activity.attachments = attachments;
              case 21:
                if (this.shouldQueue()) {
                  this.activityQueue.push(activity);
                } else {
                  this.subscriber.next(activity);
                }
                return _context.abrupt("return", BFSE.StreamingResponse.create(200));
              case 23:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));
      function processRequest(_x, _x2) {
        return _processRequest.apply(this, arguments);
      }
      return processRequest;
    }()
  }, {
    key: "flush",
    value: function flush() {
      var _this = this;
      this.connectionStatus$.subscribe(function () {});
      this.activityQueue.forEach(function (a) {
        return _this.subscriber.next(a);
      });
      this.activityQueue = [];
    }
  }, {
    key: "end",
    value: function end() {
      this.subscriber.complete();
    }
  }]);
  return StreamHandler;
}();
var _networkInformation = /*#__PURE__*/new WeakMap();
var DirectLineStreaming = /*#__PURE__*/function () {
  function DirectLineStreaming(options) {
    var _this2 = this;
    (0, _classCallCheck2["default"])(this, DirectLineStreaming);
    (0, _defineProperty2["default"])(this, "connectionStatus$", new _BehaviorSubject.BehaviorSubject(_directLine.ConnectionStatus.Uninitialized));
    (0, _defineProperty2["default"])(this, "_botAgent", '');
    _networkInformation.set(this, {
      writable: true,
      value: void 0
    });
    // Rectifies `options.networkInformation`.
    var networkInformation = options === null || options === void 0 ? void 0 : options.networkInformation;
    if (typeof networkInformation === 'undefined' || typeof networkInformation.addEventListener === 'function' && typeof networkInformation.removeEventListener === 'function' && typeof networkInformation.type === 'string') {
      (0, _classPrivateFieldSet2["default"])(this, _networkInformation, networkInformation);
    } else {
      console.warn('botframework-directlinejs: "networkInformation" option specified must be a `NetworkInformation`-like instance extending `EventTarget` interface with a `type` property returning a string.');
    }
    this.token = options.token;
    this.refreshToken()["catch"](function () {
      _this2.connectionStatus$.next(_directLine.ConnectionStatus.ExpiredToken);
    });
    this.domain = options.domain;
    if (options.conversationId) {
      this.conversationId = options.conversationId;
    }
    this._botAgent = this.getBotAgent(options.botAgent);
    this.queueActivities = true;
    this.activity$ = _Observable.Observable.create(/*#__PURE__*/function () {
      var _ref = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee2(subscriber) {
        return _regenerator["default"].wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                _this2.activitySubscriber = subscriber;
                _this2.theStreamHandler = new StreamHandler(subscriber, _this2.connectionStatus$, function () {
                  return _this2.queueActivities;
                });

                // Resolving connectDeferred will kick-off the connection.
                _this2.connectDeferred.resolve();
              case 3:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2);
      }));
      return function (_x3) {
        return _ref.apply(this, arguments);
      };
    }()).share();

    // connectWithRetryAsync() will create the connectDeferred object required in activity$.
    this.connectWithRetryAsync();
  }
  (0, _createClass2["default"])(DirectLineStreaming, [{
    key: "reconnect",
    value: function reconnect(_ref2) {
      var conversationId = _ref2.conversationId,
        token = _ref2.token;
      if (this.connectionStatus$.getValue() === _directLine.ConnectionStatus.Ended) {
        throw new Error('Connection has ended.');
      }
      this.conversationId = conversationId;
      this.token = token;
      this.connectDeferred.resolve();
    }
  }, {
    key: "end",
    value: function end() {
      // Once end() is called, no reconnection can be made.
      this.activitySubscriber.complete();
      this.connectionStatus$.next(_directLine.ConnectionStatus.Ended);
      this.connectionStatus$.complete();
      this.streamConnection.disconnect();
    }
  }, {
    key: "commonHeaders",
    value: function commonHeaders() {
      return {
        Authorization: "Bearer ".concat(this.token),
        'x-ms-bot-agent': this._botAgent
      };
    }
  }, {
    key: "getBotAgent",
    value: function getBotAgent() {
      var customAgent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
      var clientAgent = 'directlineStreaming';
      if (customAgent) {
        clientAgent += "; ".concat(customAgent);
      }
      return "".concat(DIRECT_LINE_VERSION, " (").concat(clientAgent, ")");
    }
  }, {
    key: "refreshToken",
    value: function () {
      var _refreshToken = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee3() {
        var firstCall,
          retryCount,
          numberOfAttempts,
          res,
          _yield$res$json,
          token,
          _args3 = arguments;
        return _regenerator["default"].wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                firstCall = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : true;
                retryCount = _args3.length > 1 && _args3[1] !== undefined ? _args3[1] : 0;
                _context3.next = 4;
                return this.waitUntilOnline();
              case 4:
                numberOfAttempts = 0;
              case 5:
                if (!(numberOfAttempts < MAX_RETRY_COUNT)) {
                  _context3.next = 30;
                  break;
                }
                numberOfAttempts++;
                _context3.next = 9;
                return new Promise(function (r) {
                  return setTimeout(r, refreshTokenInterval);
                });
              case 9:
                _context3.prev = 9;
                _context3.next = 12;
                return (0, _crossFetch["default"])("".concat(this.domain, "/tokens/refresh"), {
                  method: 'POST',
                  headers: this.commonHeaders()
                });
              case 12:
                res = _context3.sent;
                if (!res.ok) {
                  _context3.next = 22;
                  break;
                }
                numberOfAttempts = 0;
                _context3.next = 17;
                return res.json();
              case 17:
                _yield$res$json = _context3.sent;
                token = _yield$res$json.token;
                this.token = token;
                _context3.next = 23;
                break;
              case 22:
                if (res.status === 403 || res.status === 403) {
                  console.error("Fatal error while refreshing the token: ".concat(res.status, " ").concat(res.statusText));
                  this.streamConnection.disconnect();
                } else {
                  console.warn("Refresh attempt #".concat(numberOfAttempts, " failed: ").concat(res.status, " ").concat(res.statusText));
                }
              case 23:
                _context3.next = 28;
                break;
              case 25:
                _context3.prev = 25;
                _context3.t0 = _context3["catch"](9);
                console.warn("Refresh attempt #".concat(numberOfAttempts, " threw an exception: ").concat(_context3.t0));
              case 28:
                _context3.next = 5;
                break;
              case 30:
                console.error('Retries exhausted');
                this.streamConnection.disconnect();
              case 32:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, this, [[9, 25]]);
      }));
      function refreshToken() {
        return _refreshToken.apply(this, arguments);
      }
      return refreshToken;
    }()
  }, {
    key: "postActivity",
    value: function postActivity(activity) {
      var _this3 = this;
      if (this.connectionStatus$.value === _directLine.ConnectionStatus.Ended || this.connectionStatus$.value === _directLine.ConnectionStatus.FailedToConnect) {
        return _Observable.Observable["throw"](new Error('Connection is closed'));
      }
      if (activity.type === 'message' && activity.attachments && activity.attachments.length > 0) {
        return this.postMessageWithAttachments(activity);
      }
      var resp$ = _Observable.Observable.create(/*#__PURE__*/function () {
        var _ref3 = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee4(subscriber) {
          var request, resp, numberOfStreams, idString, _JSON$parse, id;
          return _regenerator["default"].wrap(function _callee4$(_context4) {
            while (1) {
              switch (_context4.prev = _context4.next) {
                case 0:
                  request = BFSE.StreamingRequest.create('POST', '/v3/directline/conversations/' + _this3.conversationId + '/activities');
                  request.setBody(JSON.stringify(activity));
                  _context4.prev = 2;
                  _context4.next = 5;
                  return _this3.streamConnection.send(request);
                case 5:
                  resp = _context4.sent;
                  if (!(resp.statusCode !== 200)) {
                    _context4.next = 8;
                    break;
                  }
                  throw new Error('PostActivity returned ' + resp.statusCode);
                case 8:
                  numberOfStreams = resp.streams.length;
                  if (!(numberOfStreams !== 1)) {
                    _context4.next = 11;
                    break;
                  }
                  throw new Error('Expected one stream but got ' + numberOfStreams);
                case 11:
                  _context4.next = 13;
                  return resp.streams[0].readAsString();
                case 13:
                  idString = _context4.sent;
                  _JSON$parse = JSON.parse(idString), id = _JSON$parse.Id;
                  subscriber.next(id);
                  return _context4.abrupt("return", subscriber.complete());
                case 19:
                  _context4.prev = 19;
                  _context4.t0 = _context4["catch"](2);
                  // If there is a network issue then its handled by
                  // the disconnectionHandler. Everything else can
                  // be retried
                  console.warn(_context4.t0);
                  _this3.streamConnection.disconnect();
                  return _context4.abrupt("return", subscriber.error(_context4.t0));
                case 24:
                case "end":
                  return _context4.stop();
              }
            }
          }, _callee4, null, [[2, 19]]);
        }));
        return function (_x4) {
          return _ref3.apply(this, arguments);
        };
      }());
      return resp$;
    }
  }, {
    key: "postMessageWithAttachments",
    value: function postMessageWithAttachments(message) {
      var _this4 = this;
      var attachments = message.attachments,
        messageWithoutAttachments = (0, _objectWithoutProperties2["default"])(message, _excluded);
      return _Observable.Observable.create(function (subscriber) {
        var httpContentList = [];
        (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee6() {
          var arrayBuffers, url, request, activityStream, resp, _yield$resp$streams$, id;
          return _regenerator["default"].wrap(function _callee6$(_context6) {
            while (1) {
              switch (_context6.prev = _context6.next) {
                case 0:
                  _context6.prev = 0;
                  _context6.next = 3;
                  return Promise.all(attachments.map(/*#__PURE__*/function () {
                    var _ref5 = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee5(attachment) {
                      var media, res;
                      return _regenerator["default"].wrap(function _callee5$(_context5) {
                        while (1) {
                          switch (_context5.prev = _context5.next) {
                            case 0:
                              media = attachment;
                              _context5.next = 3;
                              return (0, _crossFetch["default"])(media.contentUrl);
                            case 3:
                              res = _context5.sent;
                              if (!res.ok) {
                                _context5.next = 12;
                                break;
                              }
                              _context5.next = 7;
                              return res.arrayBuffer();
                            case 7:
                              _context5.t0 = _context5.sent;
                              _context5.t1 = media;
                              return _context5.abrupt("return", {
                                arrayBuffer: _context5.t0,
                                media: _context5.t1
                              });
                            case 12:
                              throw new Error('...');
                            case 13:
                            case "end":
                              return _context5.stop();
                          }
                        }
                      }, _callee5);
                    }));
                    return function (_x5) {
                      return _ref5.apply(this, arguments);
                    };
                  }()));
                case 3:
                  arrayBuffers = _context6.sent;
                  arrayBuffers.forEach(function (_ref6) {
                    var arrayBuffer = _ref6.arrayBuffer,
                      media = _ref6.media;
                    var buffer = _buffer.Buffer.from(arrayBuffer);
                    var stream = new BFSE.SubscribableStream();
                    stream.write(buffer);
                    var httpContent = new BFSE.HttpContent({
                      type: media.contentType,
                      contentLength: buffer.length
                    }, stream);
                    httpContentList.push(httpContent);
                  });
                  url = "/v3/directline/conversations/".concat(_this4.conversationId, "/users/").concat(messageWithoutAttachments.from.id, "/upload");
                  request = BFSE.StreamingRequest.create('PUT', url);
                  activityStream = new BFSE.SubscribableStream();
                  activityStream.write(JSON.stringify(messageWithoutAttachments), 'utf-8');
                  request.addStream(new BFSE.HttpContent({
                    type: 'application/vnd.microsoft.activity',
                    contentLength: activityStream.length
                  }, activityStream));
                  httpContentList.forEach(function (e) {
                    return request.addStream(e);
                  });
                  _context6.next = 13;
                  return _this4.streamConnection.send(request);
                case 13:
                  resp = _context6.sent;
                  if (!(resp.streams && resp.streams.length !== 1)) {
                    _context6.next = 18;
                    break;
                  }
                  subscriber.error(new Error("Invalid stream count ".concat(resp.streams.length)));
                  _context6.next = 24;
                  break;
                case 18:
                  _context6.next = 20;
                  return resp.streams[0].readAsJson();
                case 20:
                  _yield$resp$streams$ = _context6.sent;
                  id = _yield$resp$streams$.Id;
                  subscriber.next(id);
                  subscriber.complete();
                case 24:
                  _context6.next = 29;
                  break;
                case 26:
                  _context6.prev = 26;
                  _context6.t0 = _context6["catch"](0);
                  subscriber.error(_context6.t0);
                case 29:
                case "end":
                  return _context6.stop();
              }
            }
          }, _callee6, null, [[0, 26]]);
        }))();
      });
    }
  }, {
    key: "waitUntilOnline",
    value: function () {
      var _waitUntilOnline = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee7() {
        var _this5 = this;
        return _regenerator["default"].wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                return _context7.abrupt("return", new Promise(function (resolve, reject) {
                  _this5.connectionStatus$.subscribe(function (cs) {
                    if (cs === _directLine.ConnectionStatus.Online) {
                      return resolve();
                    }
                  }, function (e) {
                    return reject(e);
                  });
                }));
              case 1:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7);
      }));
      function waitUntilOnline() {
        return _waitUntilOnline.apply(this, arguments);
      }
      return waitUntilOnline;
    }()
  }, {
    key: "connectAsync",
    value: function () {
      var _connectAsync = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee9() {
        var _this6 = this;
        var re, params, abortController, urlSearchParams, wsUrl;
        return _regenerator["default"].wrap(function _callee9$(_context9) {
          while (1) {
            switch (_context9.prev = _context9.next) {
              case 0:
                re = new RegExp('^http(s?)');
                if (re.test(this.domain)) {
                  _context9.next = 3;
                  break;
                }
                throw 'Domain must begin with http or https';
              case 3:
                params = {
                  token: this.token
                };
                if (this.conversationId) {
                  params['conversationId'] = this.conversationId;
                }
                abortController = new AbortController();
                urlSearchParams = new URLSearchParams(params).toString();
                wsUrl = "".concat(this.domain.replace(re, 'ws$1'), "/conversations/connect?").concat(urlSearchParams); // This promise will resolve when it is disconnected.
                return _context9.abrupt("return", new Promise(/*#__PURE__*/function () {
                  var _ref7 = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee8(resolve, reject) {
                    var request, response, responseString, conversation;
                    return _regenerator["default"].wrap(function _callee8$(_context8) {
                      while (1) {
                        switch (_context8.prev = _context8.next) {
                          case 0:
                            _context8.prev = 0;
                            _this6.streamConnection = new _WebSocketClientWithNetworkInformation["default"]({
                              disconnectionHandler: resolve,
                              networkInformation: (0, _classPrivateFieldGet2["default"])(_this6, _networkInformation),
                              requestHandler: {
                                processRequest: function processRequest(streamingRequest) {
                                  // If `streamConnection` is still current, allow call to `processRequest()`, otherwise, ignore calls to `processRequest()`.
                                  // This prevents zombie connections from sending us requests.
                                  if (abortController.signal.aborted) {
                                    throw new Error('Cannot process streaming request, `streamingConnection` should be disconnected.');
                                  }
                                  return _this6.theStreamHandler.processRequest(streamingRequest);
                                }
                              },
                              url: wsUrl
                            });
                            _this6.queueActivities = true;
                            _context8.next = 5;
                            return _this6.streamConnection.connect();
                          case 5:
                            request = BFSE.StreamingRequest.create('POST', '/v3/directline/conversations');
                            _context8.next = 8;
                            return _this6.streamConnection.send(request);
                          case 8:
                            response = _context8.sent;
                            if (!(response.statusCode !== 200)) {
                              _context8.next = 11;
                              break;
                            }
                            throw new Error('Connection response code ' + response.statusCode);
                          case 11:
                            if (!(response.streams.length !== 1)) {
                              _context8.next = 13;
                              break;
                            }
                            throw new Error('Expected 1 stream but got ' + response.streams.length);
                          case 13:
                            _context8.next = 15;
                            return response.streams[0].readAsString();
                          case 15:
                            responseString = _context8.sent;
                            conversation = JSON.parse(responseString);
                            _this6.conversationId = conversation.conversationId;
                            _this6.connectionStatus$.next(_directLine.ConnectionStatus.Online);

                            // Wait until DL consumers have had a chance to be notified
                            // of the connection status change.
                            // This is specific to RxJS implementation of observable, which calling subscribe() after next() will still get the value.
                            _context8.next = 21;
                            return _this6.waitUntilOnline();
                          case 21:
                            _this6.theStreamHandler.flush();
                            _this6.queueActivities = false;
                            _context8.next = 28;
                            break;
                          case 25:
                            _context8.prev = 25;
                            _context8.t0 = _context8["catch"](0);
                            reject(_context8.t0);
                          case 28:
                          case "end":
                            return _context8.stop();
                        }
                      }
                    }, _callee8, null, [[0, 25]]);
                  }));
                  return function (_x6, _x7) {
                    return _ref7.apply(this, arguments);
                  };
                }())["finally"](function () {
                  return abortController.abort();
                }));
              case 9:
              case "end":
                return _context9.stop();
            }
          }
        }, _callee9, this);
      }));
      function connectAsync() {
        return _connectAsync.apply(this, arguments);
      }
      return connectAsync;
    }()
  }, {
    key: "connectWithRetryAsync",
    value: function () {
      var _connectWithRetryAsync = (0, _asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee10() {
        var _this7 = this;
        var numRetries, start;
        return _regenerator["default"].wrap(function _callee10$(_context10) {
          while (1) {
            switch (_context10.prev = _context10.next) {
              case 0:
                _context10.next = 2;
                return (this.connectDeferred = (0, _createDeferred["default"])()).promise;
              case 2:
                numRetries = MAX_RETRY_COUNT;
                this.connectionStatus$.next(_directLine.ConnectionStatus.Connecting);
              case 4:
                if (!(numRetries > 0)) {
                  _context10.next = 27;
                  break;
                }
                numRetries--;
                start = Date.now();
                _context10.prev = 7;
                _context10.next = 10;
                return this.connectAsync();
              case 10:
                _context10.next = 15;
                break;
              case 12:
                _context10.prev = 12;
                _context10.t0 = _context10["catch"](7);
                console.error(_context10.t0);
              case 15:
                if (!(this.connectionStatus$.getValue() === _directLine.ConnectionStatus.Ended)) {
                  _context10.next = 17;
                  break;
                }
                return _context10.abrupt("return");
              case 17:
                // Make sure we don't signal ConnectionStatus.Connecting twice or more without an actual connection.
                // Subsequent retries should be transparent.
                if (this.connectionStatus$.getValue() !== _directLine.ConnectionStatus.Connecting) {
                  this.connectionStatus$.next(_directLine.ConnectionStatus.Connecting);
                }

                // If the current connection lasted for more than a minute, the previous connection is good, which means:
                // - we should reset the retry counter, and;
                // - we should reconnect immediately.
                if (!(60000 < Date.now() - start)) {
                  _context10.next = 22;
                  break;
                }
                numRetries = MAX_RETRY_COUNT;
                _context10.next = 25;
                break;
              case 22:
                if (!(numRetries > 0)) {
                  _context10.next = 25;
                  break;
                }
                _context10.next = 25;
                return new Promise(function (r) {
                  return setTimeout(r, _this7.getRetryDelay());
                });
              case 25:
                _context10.next = 4;
                break;
              case 27:
                // TODO: [TEST] Make sure FailedToConnect is reported immediately after last disconnection, should be no getRetryDelay().
                // Failed to reconnect after multiple retries.
                this.connectionStatus$.next(_directLine.ConnectionStatus.FailedToConnect);
              case 28:
                _context10.next = 0;
                break;
              case 30:
              case "end":
                return _context10.stop();
            }
          }
        }, _callee10, this, [[7, 12]]);
      }));
      function connectWithRetryAsync() {
        return _connectWithRetryAsync.apply(this, arguments);
      }
      return connectWithRetryAsync;
    }() // Returns the delay duration in milliseconds
  }, {
    key: "getRetryDelay",
    value: function getRetryDelay() {
      return Math.floor(3000 + Math.random() * 12000);
    }
  }]);
  return DirectLineStreaming;
}();
exports.DirectLineStreaming = DirectLineStreaming;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQmVoYXZpb3JTdWJqZWN0IiwicmVxdWlyZSIsIl9idWZmZXIiLCJfT2JzZXJ2YWJsZSIsIkJGU0UiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIl9jcmVhdGVEZWZlcnJlZCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfY3Jvc3NGZXRjaCIsIl9kaXJlY3RMaW5lIiwiX1dlYlNvY2tldENsaWVudFdpdGhOZXR3b3JrSW5mb3JtYXRpb24iLCJfZXhjbHVkZWQiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJub2RlSW50ZXJvcCIsIldlYWtNYXAiLCJjYWNoZUJhYmVsSW50ZXJvcCIsImNhY2hlTm9kZUludGVyb3AiLCJvYmoiLCJfX2VzTW9kdWxlIiwiX3R5cGVvZiIsImNhY2hlIiwiaGFzIiwiZ2V0IiwibmV3T2JqIiwiaGFzUHJvcGVydHlEZXNjcmlwdG9yIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJrZXkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJkZXNjIiwic2V0IiwiRElSRUNUX0xJTkVfVkVSU0lPTiIsIk1BWF9SRVRSWV9DT1VOVCIsInJlZnJlc2hUb2tlbkxpZmV0aW1lIiwicmVmcmVzaFRva2VuSW50ZXJ2YWwiLCJTdHJlYW1IYW5kbGVyIiwicyIsImMkIiwic3EiLCJfY2xhc3NDYWxsQ2hlY2syIiwiX2RlZmluZVByb3BlcnR5MiIsInN1YnNjcmliZXIiLCJjb25uZWN0aW9uU3RhdHVzJCIsInNob3VsZFF1ZXVlIiwiX2NyZWF0ZUNsYXNzMiIsInZhbHVlIiwic2V0U3Vic2NyaWJlciIsIl9wcm9jZXNzUmVxdWVzdCIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9yZWdlbmVyYXRvciIsIm1hcmsiLCJfY2FsbGVlIiwicmVxdWVzdCIsImxvZ2dlciIsInN0cmVhbXMiLCJzdHJlYW0wIiwiYWN0aXZpdHlTZXRKc29uIiwiYWN0aXZpdHlTZXQiLCJhY3Rpdml0eSIsImF0dGFjaG1lbnRzIiwic3RyZWFtIiwiYXR0YWNobWVudCIsImRhdGFVcmkiLCJ3cmFwIiwiX2NhbGxlZSQiLCJfY29udGV4dCIsInByZXYiLCJuZXh0IiwiX3RvQ29uc3VtYWJsZUFycmF5MiIsInNoaWZ0IiwicmVhZEFzU3RyaW5nIiwic2VudCIsIkpTT04iLCJwYXJzZSIsImFjdGl2aXRpZXMiLCJsZW5ndGgiLCJlcnJvciIsIkVycm9yIiwiYWJydXB0IiwiU3RyZWFtaW5nUmVzcG9uc2UiLCJjcmVhdGUiLCJwdXNoIiwiY29udGVudFR5cGUiLCJjb250ZW50VXJsIiwiYWN0aXZpdHlRdWV1ZSIsInN0b3AiLCJwcm9jZXNzUmVxdWVzdCIsIl94IiwiX3gyIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJmbHVzaCIsIl90aGlzIiwic3Vic2NyaWJlIiwiZm9yRWFjaCIsImEiLCJlbmQiLCJjb21wbGV0ZSIsIl9uZXR3b3JrSW5mb3JtYXRpb24iLCJEaXJlY3RMaW5lU3RyZWFtaW5nIiwib3B0aW9ucyIsIl90aGlzMiIsIkJlaGF2aW9yU3ViamVjdCIsIkNvbm5lY3Rpb25TdGF0dXMiLCJVbmluaXRpYWxpemVkIiwid3JpdGFibGUiLCJuZXR3b3JrSW5mb3JtYXRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInR5cGUiLCJfY2xhc3NQcml2YXRlRmllbGRTZXQyIiwiY29uc29sZSIsIndhcm4iLCJ0b2tlbiIsInJlZnJlc2hUb2tlbiIsIkV4cGlyZWRUb2tlbiIsImRvbWFpbiIsImNvbnZlcnNhdGlvbklkIiwiX2JvdEFnZW50IiwiZ2V0Qm90QWdlbnQiLCJib3RBZ2VudCIsInF1ZXVlQWN0aXZpdGllcyIsImFjdGl2aXR5JCIsIk9ic2VydmFibGUiLCJfcmVmIiwiX2NhbGxlZTIiLCJfY2FsbGVlMiQiLCJfY29udGV4dDIiLCJhY3Rpdml0eVN1YnNjcmliZXIiLCJ0aGVTdHJlYW1IYW5kbGVyIiwiY29ubmVjdERlZmVycmVkIiwicmVzb2x2ZSIsIl94MyIsInNoYXJlIiwiY29ubmVjdFdpdGhSZXRyeUFzeW5jIiwicmVjb25uZWN0IiwiX3JlZjIiLCJnZXRWYWx1ZSIsIkVuZGVkIiwic3RyZWFtQ29ubmVjdGlvbiIsImRpc2Nvbm5lY3QiLCJjb21tb25IZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImNvbmNhdCIsImN1c3RvbUFnZW50IiwidW5kZWZpbmVkIiwiY2xpZW50QWdlbnQiLCJfcmVmcmVzaFRva2VuIiwiX2NhbGxlZTMiLCJmaXJzdENhbGwiLCJyZXRyeUNvdW50IiwibnVtYmVyT2ZBdHRlbXB0cyIsInJlcyIsIl95aWVsZCRyZXMkanNvbiIsIl9hcmdzMyIsIl9jYWxsZWUzJCIsIl9jb250ZXh0MyIsIndhaXRVbnRpbE9ubGluZSIsIlByb21pc2UiLCJyIiwic2V0VGltZW91dCIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIm9rIiwianNvbiIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJ0MCIsInBvc3RBY3Rpdml0eSIsIl90aGlzMyIsIkZhaWxlZFRvQ29ubmVjdCIsInBvc3RNZXNzYWdlV2l0aEF0dGFjaG1lbnRzIiwicmVzcCQiLCJfcmVmMyIsIl9jYWxsZWU0IiwicmVzcCIsIm51bWJlck9mU3RyZWFtcyIsImlkU3RyaW5nIiwiX0pTT04kcGFyc2UiLCJpZCIsIl9jYWxsZWU0JCIsIl9jb250ZXh0NCIsIlN0cmVhbWluZ1JlcXVlc3QiLCJzZXRCb2R5Iiwic3RyaW5naWZ5Iiwic2VuZCIsInN0YXR1c0NvZGUiLCJJZCIsIl94NCIsIm1lc3NhZ2UiLCJfdGhpczQiLCJtZXNzYWdlV2l0aG91dEF0dGFjaG1lbnRzIiwiX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzMiIsImh0dHBDb250ZW50TGlzdCIsIl9jYWxsZWU2IiwiYXJyYXlCdWZmZXJzIiwidXJsIiwiYWN0aXZpdHlTdHJlYW0iLCJfeWllbGQkcmVzcCRzdHJlYW1zJCIsIl9jYWxsZWU2JCIsIl9jb250ZXh0NiIsImFsbCIsIm1hcCIsIl9yZWY1IiwiX2NhbGxlZTUiLCJtZWRpYSIsIl9jYWxsZWU1JCIsIl9jb250ZXh0NSIsImFycmF5QnVmZmVyIiwidDEiLCJfeDUiLCJfcmVmNiIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJTdWJzY3JpYmFibGVTdHJlYW0iLCJ3cml0ZSIsImh0dHBDb250ZW50IiwiSHR0cENvbnRlbnQiLCJjb250ZW50TGVuZ3RoIiwiYWRkU3RyZWFtIiwiZSIsInJlYWRBc0pzb24iLCJfd2FpdFVudGlsT25saW5lIiwiX2NhbGxlZTciLCJfdGhpczUiLCJfY2FsbGVlNyQiLCJfY29udGV4dDciLCJyZWplY3QiLCJjcyIsIk9ubGluZSIsIl9jb25uZWN0QXN5bmMiLCJfY2FsbGVlOSIsIl90aGlzNiIsInJlIiwicGFyYW1zIiwiYWJvcnRDb250cm9sbGVyIiwidXJsU2VhcmNoUGFyYW1zIiwid3NVcmwiLCJfY2FsbGVlOSQiLCJfY29udGV4dDkiLCJSZWdFeHAiLCJ0ZXN0IiwiQWJvcnRDb250cm9sbGVyIiwiVVJMU2VhcmNoUGFyYW1zIiwidG9TdHJpbmciLCJyZXBsYWNlIiwiX3JlZjciLCJfY2FsbGVlOCIsInJlc3BvbnNlIiwicmVzcG9uc2VTdHJpbmciLCJjb252ZXJzYXRpb24iLCJfY2FsbGVlOCQiLCJfY29udGV4dDgiLCJXZWJTb2NrZXRDbGllbnRXaXRoTmV0d29ya0luZm9ybWF0aW9uIiwiZGlzY29ubmVjdGlvbkhhbmRsZXIiLCJfY2xhc3NQcml2YXRlRmllbGRHZXQyIiwicmVxdWVzdEhhbmRsZXIiLCJzdHJlYW1pbmdSZXF1ZXN0Iiwic2lnbmFsIiwiYWJvcnRlZCIsImNvbm5lY3QiLCJfeDYiLCJfeDciLCJhYm9ydCIsImNvbm5lY3RBc3luYyIsIl9jb25uZWN0V2l0aFJldHJ5QXN5bmMiLCJfY2FsbGVlMTAiLCJfdGhpczciLCJudW1SZXRyaWVzIiwic3RhcnQiLCJfY2FsbGVlMTAkIiwiX2NvbnRleHQxMCIsImNyZWF0ZURlZmVycmVkIiwicHJvbWlzZSIsIkNvbm5lY3RpbmciLCJEYXRlIiwibm93IiwiZ2V0UmV0cnlEZWxheSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi9zcmMvZGlyZWN0TGluZVN0cmVhbWluZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJbiBvcmRlciB0byBrZWVwIGZpbGUgc2l6ZSBkb3duLCBvbmx5IGltcG9ydCB0aGUgcGFydHMgb2YgcnhqcyB0aGF0IHdlIHVzZVxuXG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzL0JlaGF2aW9yU3ViamVjdCc7XG5pbXBvcnQgeyBCdWZmZXIgfSBmcm9tICdidWZmZXInO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMvT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBTdWJzY3JpYmVyIH0gZnJvbSAncnhqcy9TdWJzY3JpYmVyJztcbmltcG9ydCAqIGFzIEJGU0UgZnJvbSAnYm90ZnJhbWV3b3JrLXN0cmVhbWluZyc7XG5pbXBvcnQgY3JlYXRlRGVmZXJyZWQgZnJvbSAnLi9jcmVhdGVEZWZlcnJlZCc7XG5pbXBvcnQgZmV0Y2ggZnJvbSAnY3Jvc3MtZmV0Y2gnO1xuXG5pbXBvcnQgeyBBY3Rpdml0eSwgQ29ubmVjdGlvblN0YXR1cywgQ29udmVyc2F0aW9uLCBEaXJlY3RMaW5lLCBJQm90Q29ubmVjdGlvbiwgTWVkaWEsIE1lc3NhZ2UgfSBmcm9tICcuL2RpcmVjdExpbmUnO1xuaW1wb3J0IFdlYlNvY2tldENsaWVudFdpdGhOZXR3b3JrSW5mb3JtYXRpb24gZnJvbSAnLi9zdHJlYW1pbmcvV2ViU29ja2V0Q2xpZW50V2l0aE5ldHdvcmtJbmZvcm1hdGlvbic7XG5pbXBvcnQgdHlwZSB7IERlZmVycmVkIH0gZnJvbSAnLi9jcmVhdGVEZWZlcnJlZCc7XG5cbmNvbnN0IERJUkVDVF9MSU5FX1ZFUlNJT04gPSAnRGlyZWN0TGluZS8zLjAnO1xuY29uc3QgTUFYX1JFVFJZX0NPVU5UID0gMztcbmNvbnN0IHJlZnJlc2hUb2tlbkxpZmV0aW1lID0gMzAgKiA2MCAqIDEwMDA7XG4vL2NvbnN0IHJlZnJlc2hUb2tlbkxpZmV0aW1lID0gNTAwMDtcbi8vIGNvbnN0IHRpbWVvdXQgPSAyMCAqIDEwMDA7XG5jb25zdCByZWZyZXNoVG9rZW5JbnRlcnZhbCA9IHJlZnJlc2hUb2tlbkxpZmV0aW1lIC8gMjtcblxuaW50ZXJmYWNlIERpcmVjdExpbmVTdHJlYW1pbmdPcHRpb25zIHtcbiAgdG9rZW46IHN0cmluZztcbiAgY29udmVyc2F0aW9uSWQ/OiBzdHJpbmc7XG4gIGRvbWFpbjogc3RyaW5nO1xuICAvLyBBdHRhY2hlZCB0byBhbGwgcmVxdWVzdHMgdG8gaWRlbnRpZnkgcmVxdWVzdGluZyBhZ2VudC5cbiAgYm90QWdlbnQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIFtgTmV0d29ya0luZm9ybWF0aW9uYCBBUEldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9OZXR3b3JrX0luZm9ybWF0aW9uX0FQSSkuXG4gICAqIFdoZW4gdGhlIGBOZXR3b3JrSW5mb3JtYXRpb25gIGRldGVjdCBuZXR3b3JrIGNoYW5nZXMgb3Igb2ZmbGluZSwgaXQgd2lsbCBkaXNjb25uZWN0IHRoZSBXZWIgU29ja2V0IGFuZCByZWNvbm5lY3QgaXQuXG4gICAqL1xuICBuZXR3b3JrSW5mb3JtYXRpb24/OiBOZXR3b3JrSW5mb3JtYXRpb247XG59XG5cbmNsYXNzIFN0cmVhbUhhbmRsZXIgaW1wbGVtZW50cyBCRlNFLlJlcXVlc3RIYW5kbGVyIHtcbiAgcHJpdmF0ZSBjb25uZWN0aW9uU3RhdHVzJDtcbiAgcHJpdmF0ZSBzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPEFjdGl2aXR5PjtcbiAgcHJpdmF0ZSBzaG91bGRRdWV1ZTogKCkgPT4gYm9vbGVhbjtcbiAgcHJpdmF0ZSBhY3Rpdml0eVF1ZXVlOiBBcnJheTxBY3Rpdml0eT4gPSBbXTtcblxuICBjb25zdHJ1Y3RvcihzOiBTdWJzY3JpYmVyPEFjdGl2aXR5PiwgYyQ6IE9ic2VydmFibGU8Q29ubmVjdGlvblN0YXR1cz4sIHNxOiAoKSA9PiBib29sZWFuKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVyID0gcztcbiAgICB0aGlzLmNvbm5lY3Rpb25TdGF0dXMkID0gYyQ7XG4gICAgdGhpcy5zaG91bGRRdWV1ZSA9IHNxO1xuICB9XG5cbiAgcHVibGljIHNldFN1YnNjcmliZXIoczogU3Vic2NyaWJlcjxBY3Rpdml0eT4pIHtcbiAgICB0aGlzLnN1YnNjcmliZXIgPSBzO1xuICB9XG5cbiAgYXN5bmMgcHJvY2Vzc1JlcXVlc3QocmVxdWVzdDogQkZTRS5JUmVjZWl2ZVJlcXVlc3QsIGxvZ2dlcj86IGFueSk6IFByb21pc2U8QkZTRS5TdHJlYW1pbmdSZXNwb25zZT4ge1xuICAgIGNvbnN0IHN0cmVhbXMgPSBbLi4ucmVxdWVzdC5zdHJlYW1zXTtcbiAgICBjb25zdCBzdHJlYW0wID0gc3RyZWFtcy5zaGlmdCgpO1xuICAgIGNvbnN0IGFjdGl2aXR5U2V0SnNvbiA9IGF3YWl0IHN0cmVhbTAucmVhZEFzU3RyaW5nKCk7XG4gICAgY29uc3QgYWN0aXZpdHlTZXQgPSBKU09OLnBhcnNlKGFjdGl2aXR5U2V0SnNvbik7XG5cbiAgICBpZiAoYWN0aXZpdHlTZXQuYWN0aXZpdGllcy5sZW5ndGggIT09IDEpIHtcbiAgICAgIC8vIE9ubHkgb25lIGFjdGl2aXR5IGlzIGV4cGVjdGVkIGluIGEgc2V0IGluIHN0cmVhbWluZ1xuICAgICAgdGhpcy5zdWJzY3JpYmVyLmVycm9yKG5ldyBFcnJvcigndGhlcmUgc2hvdWxkIGJlIGV4YWN0bHkgb25lIGFjdGl2aXR5JykpO1xuICAgICAgcmV0dXJuIEJGU0UuU3RyZWFtaW5nUmVzcG9uc2UuY3JlYXRlKDUwMCk7XG4gICAgfVxuXG4gICAgY29uc3QgYWN0aXZpdHkgPSBhY3Rpdml0eVNldC5hY3Rpdml0aWVzWzBdO1xuXG4gICAgaWYgKHN0cmVhbXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgYXR0YWNobWVudHMgPSBbLi4uYWN0aXZpdHkuYXR0YWNobWVudHNdO1xuXG4gICAgICBsZXQgc3RyZWFtOiBCRlNFLkNvbnRlbnRTdHJlYW07XG4gICAgICB3aGlsZSAoKHN0cmVhbSA9IHN0cmVhbXMuc2hpZnQoKSkpIHtcbiAgICAgICAgY29uc3QgYXR0YWNobWVudCA9IGF3YWl0IHN0cmVhbS5yZWFkQXNTdHJpbmcoKTtcbiAgICAgICAgY29uc3QgZGF0YVVyaSA9ICdkYXRhOnRleHQvcGxhaW47YmFzZTY0LCcgKyBhdHRhY2htZW50O1xuICAgICAgICBhdHRhY2htZW50cy5wdXNoKHsgY29udGVudFR5cGU6IHN0cmVhbS5jb250ZW50VHlwZSwgY29udGVudFVybDogZGF0YVVyaSB9KTtcbiAgICAgIH1cblxuICAgICAgYWN0aXZpdHkuYXR0YWNobWVudHMgPSBhdHRhY2htZW50cztcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zaG91bGRRdWV1ZSgpKSB7XG4gICAgICB0aGlzLmFjdGl2aXR5UXVldWUucHVzaChhY3Rpdml0eSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3Vic2NyaWJlci5uZXh0KGFjdGl2aXR5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gQkZTRS5TdHJlYW1pbmdSZXNwb25zZS5jcmVhdGUoMjAwKTtcbiAgfVxuXG4gIHB1YmxpYyBmbHVzaCgpIHtcbiAgICB0aGlzLmNvbm5lY3Rpb25TdGF0dXMkLnN1YnNjcmliZSgoKSA9PiB7fSk7XG4gICAgdGhpcy5hY3Rpdml0eVF1ZXVlLmZvckVhY2goYSA9PiB0aGlzLnN1YnNjcmliZXIubmV4dChhKSk7XG4gICAgdGhpcy5hY3Rpdml0eVF1ZXVlID0gW107XG4gIH1cblxuICBwdWJsaWMgZW5kKCkge1xuICAgIHRoaXMuc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEaXJlY3RMaW5lU3RyZWFtaW5nIGltcGxlbWVudHMgSUJvdENvbm5lY3Rpb24ge1xuICBwdWJsaWMgY29ubmVjdGlvblN0YXR1cyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KENvbm5lY3Rpb25TdGF0dXMuVW5pbml0aWFsaXplZCk7XG4gIHB1YmxpYyBhY3Rpdml0eSQ6IE9ic2VydmFibGU8QWN0aXZpdHk+O1xuXG4gIHByaXZhdGUgYWN0aXZpdHlTdWJzY3JpYmVyOiBTdWJzY3JpYmVyPEFjdGl2aXR5PjtcbiAgcHJpdmF0ZSBjb25uZWN0RGVmZXJyZWQ6IERlZmVycmVkPHZvaWQ+O1xuICBwcml2YXRlIHRoZVN0cmVhbUhhbmRsZXI6IFN0cmVhbUhhbmRsZXI7XG5cbiAgcHJpdmF0ZSBkb21haW46IHN0cmluZztcblxuICBwcml2YXRlIGNvbnZlcnNhdGlvbklkOiBzdHJpbmc7XG4gIHByaXZhdGUgdG9rZW46IHN0cmluZztcbiAgcHJpdmF0ZSBzdHJlYW1Db25uZWN0aW9uOiBCRlNFLldlYlNvY2tldENsaWVudDtcbiAgcHJpdmF0ZSBxdWV1ZUFjdGl2aXRpZXM6IGJvb2xlYW47XG5cbiAgcHJpdmF0ZSBfYm90QWdlbnQgPSAnJztcblxuICAjbmV0d29ya0luZm9ybWF0aW9uOiBOZXR3b3JrSW5mb3JtYXRpb24gfCB1bmRlZmluZWQ7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogRGlyZWN0TGluZVN0cmVhbWluZ09wdGlvbnMpIHtcbiAgICAvLyBSZWN0aWZpZXMgYG9wdGlvbnMubmV0d29ya0luZm9ybWF0aW9uYC5cbiAgICBjb25zdCBuZXR3b3JrSW5mb3JtYXRpb24gPSBvcHRpb25zPy5uZXR3b3JrSW5mb3JtYXRpb247XG5cbiAgICBpZiAoXG4gICAgICB0eXBlb2YgbmV0d29ya0luZm9ybWF0aW9uID09PSAndW5kZWZpbmVkJyB8fFxuICAgICAgKHR5cGVvZiBuZXR3b3JrSW5mb3JtYXRpb24uYWRkRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgICB0eXBlb2YgbmV0d29ya0luZm9ybWF0aW9uLnJlbW92ZUV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicgJiZcbiAgICAgICAgdHlwZW9mIG5ldHdvcmtJbmZvcm1hdGlvbi50eXBlID09PSAnc3RyaW5nJylcbiAgICApIHtcbiAgICAgIHRoaXMuI25ldHdvcmtJbmZvcm1hdGlvbiA9IG5ldHdvcmtJbmZvcm1hdGlvbjtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnYm90ZnJhbWV3b3JrLWRpcmVjdGxpbmVqczogXCJuZXR3b3JrSW5mb3JtYXRpb25cIiBvcHRpb24gc3BlY2lmaWVkIG11c3QgYmUgYSBgTmV0d29ya0luZm9ybWF0aW9uYC1saWtlIGluc3RhbmNlIGV4dGVuZGluZyBgRXZlbnRUYXJnZXRgIGludGVyZmFjZSB3aXRoIGEgYHR5cGVgIHByb3BlcnR5IHJldHVybmluZyBhIHN0cmluZy4nXG4gICAgICApO1xuICAgIH1cblxuICAgIHRoaXMudG9rZW4gPSBvcHRpb25zLnRva2VuO1xuXG4gICAgdGhpcy5yZWZyZXNoVG9rZW4oKS5jYXRjaCgoKSA9PiB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0dXMkLm5leHQoQ29ubmVjdGlvblN0YXR1cy5FeHBpcmVkVG9rZW4pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5kb21haW4gPSBvcHRpb25zLmRvbWFpbjtcblxuICAgIGlmIChvcHRpb25zLmNvbnZlcnNhdGlvbklkKSB7XG4gICAgICB0aGlzLmNvbnZlcnNhdGlvbklkID0gb3B0aW9ucy5jb252ZXJzYXRpb25JZDtcbiAgICB9XG5cbiAgICB0aGlzLl9ib3RBZ2VudCA9IHRoaXMuZ2V0Qm90QWdlbnQob3B0aW9ucy5ib3RBZ2VudCk7XG5cbiAgICB0aGlzLnF1ZXVlQWN0aXZpdGllcyA9IHRydWU7XG4gICAgdGhpcy5hY3Rpdml0eSQgPSBPYnNlcnZhYmxlLmNyZWF0ZShhc3luYyAoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxBY3Rpdml0eT4pID0+IHtcbiAgICAgIHRoaXMuYWN0aXZpdHlTdWJzY3JpYmVyID0gc3Vic2NyaWJlcjtcbiAgICAgIHRoaXMudGhlU3RyZWFtSGFuZGxlciA9IG5ldyBTdHJlYW1IYW5kbGVyKHN1YnNjcmliZXIsIHRoaXMuY29ubmVjdGlvblN0YXR1cyQsICgpID0+IHRoaXMucXVldWVBY3Rpdml0aWVzKTtcblxuICAgICAgLy8gUmVzb2x2aW5nIGNvbm5lY3REZWZlcnJlZCB3aWxsIGtpY2stb2ZmIHRoZSBjb25uZWN0aW9uLlxuICAgICAgdGhpcy5jb25uZWN0RGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgIH0pLnNoYXJlKCk7XG5cbiAgICAvLyBjb25uZWN0V2l0aFJldHJ5QXN5bmMoKSB3aWxsIGNyZWF0ZSB0aGUgY29ubmVjdERlZmVycmVkIG9iamVjdCByZXF1aXJlZCBpbiBhY3Rpdml0eSQuXG4gICAgdGhpcy5jb25uZWN0V2l0aFJldHJ5QXN5bmMoKTtcbiAgfVxuXG4gIHB1YmxpYyByZWNvbm5lY3QoeyBjb252ZXJzYXRpb25JZCwgdG9rZW4gfTogQ29udmVyc2F0aW9uKSB7XG4gICAgaWYgKHRoaXMuY29ubmVjdGlvblN0YXR1cyQuZ2V0VmFsdWUoKSA9PT0gQ29ubmVjdGlvblN0YXR1cy5FbmRlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb25uZWN0aW9uIGhhcyBlbmRlZC4nKTtcbiAgICB9XG5cbiAgICB0aGlzLmNvbnZlcnNhdGlvbklkID0gY29udmVyc2F0aW9uSWQ7XG4gICAgdGhpcy50b2tlbiA9IHRva2VuO1xuXG4gICAgdGhpcy5jb25uZWN0RGVmZXJyZWQucmVzb2x2ZSgpO1xuICB9XG5cbiAgZW5kKCkge1xuICAgIC8vIE9uY2UgZW5kKCkgaXMgY2FsbGVkLCBubyByZWNvbm5lY3Rpb24gY2FuIGJlIG1hZGUuXG4gICAgdGhpcy5hY3Rpdml0eVN1YnNjcmliZXIuY29tcGxldGUoKTtcblxuICAgIHRoaXMuY29ubmVjdGlvblN0YXR1cyQubmV4dChDb25uZWN0aW9uU3RhdHVzLkVuZGVkKTtcbiAgICB0aGlzLmNvbm5lY3Rpb25TdGF0dXMkLmNvbXBsZXRlKCk7XG5cbiAgICB0aGlzLnN0cmVhbUNvbm5lY3Rpb24uZGlzY29ubmVjdCgpO1xuICB9XG5cbiAgcHJpdmF0ZSBjb21tb25IZWFkZXJzKCkge1xuICAgIHJldHVybiB7XG4gICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy50b2tlbn1gLFxuICAgICAgJ3gtbXMtYm90LWFnZW50JzogdGhpcy5fYm90QWdlbnRcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRCb3RBZ2VudChjdXN0b21BZ2VudDogc3RyaW5nID0gJycpOiBzdHJpbmcge1xuICAgIGxldCBjbGllbnRBZ2VudCA9ICdkaXJlY3RsaW5lU3RyZWFtaW5nJztcblxuICAgIGlmIChjdXN0b21BZ2VudCkge1xuICAgICAgY2xpZW50QWdlbnQgKz0gYDsgJHtjdXN0b21BZ2VudH1gO1xuICAgIH1cblxuICAgIHJldHVybiBgJHtESVJFQ1RfTElORV9WRVJTSU9OfSAoJHtjbGllbnRBZ2VudH0pYDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaFRva2VuKGZpcnN0Q2FsbCA9IHRydWUsIHJldHJ5Q291bnQgPSAwKSB7XG4gICAgYXdhaXQgdGhpcy53YWl0VW50aWxPbmxpbmUoKTtcblxuICAgIGxldCBudW1iZXJPZkF0dGVtcHRzID0gMDtcbiAgICB3aGlsZSAobnVtYmVyT2ZBdHRlbXB0cyA8IE1BWF9SRVRSWV9DT1VOVCkge1xuICAgICAgbnVtYmVyT2ZBdHRlbXB0cysrO1xuICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIHJlZnJlc2hUb2tlbkludGVydmFsKSk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmRvbWFpbn0vdG9rZW5zL3JlZnJlc2hgLCB7IG1ldGhvZDogJ1BPU1QnLCBoZWFkZXJzOiB0aGlzLmNvbW1vbkhlYWRlcnMoKSB9KTtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIG51bWJlck9mQXR0ZW1wdHMgPSAwO1xuICAgICAgICAgIGNvbnN0IHsgdG9rZW4gfSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgdGhpcy50b2tlbiA9IHRva2VuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09PSA0MDMgfHwgcmVzLnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGYXRhbCBlcnJvciB3aGlsZSByZWZyZXNoaW5nIHRoZSB0b2tlbjogJHtyZXMuc3RhdHVzfSAke3Jlcy5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgICAgdGhpcy5zdHJlYW1Db25uZWN0aW9uLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGBSZWZyZXNoIGF0dGVtcHQgIyR7bnVtYmVyT2ZBdHRlbXB0c30gZmFpbGVkOiAke3Jlcy5zdGF0dXN9ICR7cmVzLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgUmVmcmVzaCBhdHRlbXB0ICMke251bWJlck9mQXR0ZW1wdHN9IHRocmV3IGFuIGV4Y2VwdGlvbjogJHtlfWApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUuZXJyb3IoJ1JldHJpZXMgZXhoYXVzdGVkJyk7XG4gICAgdGhpcy5zdHJlYW1Db25uZWN0aW9uLmRpc2Nvbm5lY3QoKTtcbiAgfVxuXG4gIHBvc3RBY3Rpdml0eShhY3Rpdml0eTogQWN0aXZpdHkpIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0dXMkLnZhbHVlID09PSBDb25uZWN0aW9uU3RhdHVzLkVuZGVkIHx8XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0dXMkLnZhbHVlID09PSBDb25uZWN0aW9uU3RhdHVzLkZhaWxlZFRvQ29ubmVjdFxuICAgICkge1xuICAgICAgcmV0dXJuIE9ic2VydmFibGUudGhyb3cobmV3IEVycm9yKCdDb25uZWN0aW9uIGlzIGNsb3NlZCcpKTtcbiAgICB9XG5cbiAgICBpZiAoYWN0aXZpdHkudHlwZSA9PT0gJ21lc3NhZ2UnICYmIGFjdGl2aXR5LmF0dGFjaG1lbnRzICYmIGFjdGl2aXR5LmF0dGFjaG1lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB0aGlzLnBvc3RNZXNzYWdlV2l0aEF0dGFjaG1lbnRzKGFjdGl2aXR5KTtcbiAgICB9XG5cbiAgICBjb25zdCByZXNwJCA9IE9ic2VydmFibGUuY3JlYXRlKGFzeW5jIHN1YnNjcmliZXIgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdCA9IEJGU0UuU3RyZWFtaW5nUmVxdWVzdC5jcmVhdGUoXG4gICAgICAgICdQT1NUJyxcbiAgICAgICAgJy92My9kaXJlY3RsaW5lL2NvbnZlcnNhdGlvbnMvJyArIHRoaXMuY29udmVyc2F0aW9uSWQgKyAnL2FjdGl2aXRpZXMnXG4gICAgICApO1xuICAgICAgcmVxdWVzdC5zZXRCb2R5KEpTT04uc3RyaW5naWZ5KGFjdGl2aXR5KSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCB0aGlzLnN0cmVhbUNvbm5lY3Rpb24uc2VuZChyZXF1ZXN0KTtcbiAgICAgICAgaWYgKHJlc3Auc3RhdHVzQ29kZSAhPT0gMjAwKSB0aHJvdyBuZXcgRXJyb3IoJ1Bvc3RBY3Rpdml0eSByZXR1cm5lZCAnICsgcmVzcC5zdGF0dXNDb2RlKTtcbiAgICAgICAgY29uc3QgbnVtYmVyT2ZTdHJlYW1zID0gcmVzcC5zdHJlYW1zLmxlbmd0aDtcbiAgICAgICAgaWYgKG51bWJlck9mU3RyZWFtcyAhPT0gMSkgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCBvbmUgc3RyZWFtIGJ1dCBnb3QgJyArIG51bWJlck9mU3RyZWFtcyk7XG4gICAgICAgIGNvbnN0IGlkU3RyaW5nID0gYXdhaXQgcmVzcC5zdHJlYW1zWzBdLnJlYWRBc1N0cmluZygpO1xuICAgICAgICBjb25zdCB7IElkOiBpZCB9ID0gSlNPTi5wYXJzZShpZFN0cmluZyk7XG4gICAgICAgIHN1YnNjcmliZXIubmV4dChpZCk7XG4gICAgICAgIHJldHVybiBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIElmIHRoZXJlIGlzIGEgbmV0d29yayBpc3N1ZSB0aGVuIGl0cyBoYW5kbGVkIGJ5XG4gICAgICAgIC8vIHRoZSBkaXNjb25uZWN0aW9uSGFuZGxlci4gRXZlcnl0aGluZyBlbHNlIGNhblxuICAgICAgICAvLyBiZSByZXRyaWVkXG4gICAgICAgIGNvbnNvbGUud2FybihlKTtcbiAgICAgICAgdGhpcy5zdHJlYW1Db25uZWN0aW9uLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgcmV0dXJuIHN1YnNjcmliZXIuZXJyb3IoZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3AkO1xuICB9XG5cbiAgcHJpdmF0ZSBwb3N0TWVzc2FnZVdpdGhBdHRhY2htZW50cyhtZXNzYWdlOiBNZXNzYWdlKSB7XG4gICAgY29uc3QgeyBhdHRhY2htZW50cywgLi4ubWVzc2FnZVdpdGhvdXRBdHRhY2htZW50cyB9ID0gbWVzc2FnZTtcblxuICAgIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZShzdWJzY3JpYmVyID0+IHtcbiAgICAgIGNvbnN0IGh0dHBDb250ZW50TGlzdCA9IFtdO1xuICAgICAgKGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBhcnJheUJ1ZmZlcnMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgIGF0dGFjaG1lbnRzLm1hcChhc3luYyBhdHRhY2htZW50ID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgbWVkaWEgPSBhdHRhY2htZW50IGFzIE1lZGlhO1xuICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChtZWRpYS5jb250ZW50VXJsKTtcbiAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IGFycmF5QnVmZmVyOiBhd2FpdCByZXMuYXJyYXlCdWZmZXIoKSwgbWVkaWEgfTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJy4uLicpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBhcnJheUJ1ZmZlcnMuZm9yRWFjaCgoeyBhcnJheUJ1ZmZlciwgbWVkaWEgfSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20oYXJyYXlCdWZmZXIpO1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gbmV3IEJGU0UuU3Vic2NyaWJhYmxlU3RyZWFtKCk7XG4gICAgICAgICAgICBzdHJlYW0ud3JpdGUoYnVmZmVyKTtcbiAgICAgICAgICAgIGNvbnN0IGh0dHBDb250ZW50ID0gbmV3IEJGU0UuSHR0cENvbnRlbnQoeyB0eXBlOiBtZWRpYS5jb250ZW50VHlwZSwgY29udGVudExlbmd0aDogYnVmZmVyLmxlbmd0aCB9LCBzdHJlYW0pO1xuICAgICAgICAgICAgaHR0cENvbnRlbnRMaXN0LnB1c2goaHR0cENvbnRlbnQpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3QgdXJsID0gYC92My9kaXJlY3RsaW5lL2NvbnZlcnNhdGlvbnMvJHt0aGlzLmNvbnZlcnNhdGlvbklkfS91c2Vycy8ke21lc3NhZ2VXaXRob3V0QXR0YWNobWVudHMuZnJvbS5pZH0vdXBsb2FkYDtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gQkZTRS5TdHJlYW1pbmdSZXF1ZXN0LmNyZWF0ZSgnUFVUJywgdXJsKTtcbiAgICAgICAgICBjb25zdCBhY3Rpdml0eVN0cmVhbSA9IG5ldyBCRlNFLlN1YnNjcmliYWJsZVN0cmVhbSgpO1xuICAgICAgICAgIGFjdGl2aXR5U3RyZWFtLndyaXRlKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VXaXRob3V0QXR0YWNobWVudHMpLCAndXRmLTgnKTtcbiAgICAgICAgICByZXF1ZXN0LmFkZFN0cmVhbShcbiAgICAgICAgICAgIG5ldyBCRlNFLkh0dHBDb250ZW50KFxuICAgICAgICAgICAgICB7IHR5cGU6ICdhcHBsaWNhdGlvbi92bmQubWljcm9zb2Z0LmFjdGl2aXR5JywgY29udGVudExlbmd0aDogYWN0aXZpdHlTdHJlYW0ubGVuZ3RoIH0sXG4gICAgICAgICAgICAgIGFjdGl2aXR5U3RyZWFtXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgICBodHRwQ29udGVudExpc3QuZm9yRWFjaChlID0+IHJlcXVlc3QuYWRkU3RyZWFtKGUpKTtcblxuICAgICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCB0aGlzLnN0cmVhbUNvbm5lY3Rpb24uc2VuZChyZXF1ZXN0KTtcbiAgICAgICAgICBpZiAocmVzcC5zdHJlYW1zICYmIHJlc3Auc3RyZWFtcy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IobmV3IEVycm9yKGBJbnZhbGlkIHN0cmVhbSBjb3VudCAke3Jlc3Auc3RyZWFtcy5sZW5ndGh9YCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB7IElkOiBpZCB9ID0gYXdhaXQgcmVzcC5zdHJlYW1zWzBdLnJlYWRBc0pzb248eyBJZDogc3RyaW5nIH0+KCk7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQoaWQpO1xuICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICAgIH0pKCk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHdhaXRVbnRpbE9ubGluZSgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdGhpcy5jb25uZWN0aW9uU3RhdHVzJC5zdWJzY3JpYmUoXG4gICAgICAgIGNzID0+IHtcbiAgICAgICAgICBpZiAoY3MgPT09IENvbm5lY3Rpb25TdGF0dXMuT25saW5lKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZSA9PiByZWplY3QoZSlcbiAgICAgICk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNvbm5lY3RBc3luYygpIHtcbiAgICBjb25zdCByZSA9IG5ldyBSZWdFeHAoJ15odHRwKHM/KScpO1xuXG4gICAgaWYgKCFyZS50ZXN0KHRoaXMuZG9tYWluKSkge1xuICAgICAgdGhyb3cgJ0RvbWFpbiBtdXN0IGJlZ2luIHdpdGggaHR0cCBvciBodHRwcyc7XG4gICAgfVxuXG4gICAgY29uc3QgcGFyYW1zID0geyB0b2tlbjogdGhpcy50b2tlbiB9O1xuXG4gICAgaWYgKHRoaXMuY29udmVyc2F0aW9uSWQpIHtcbiAgICAgIHBhcmFtc1snY29udmVyc2F0aW9uSWQnXSA9IHRoaXMuY29udmVyc2F0aW9uSWQ7XG4gICAgfVxuXG4gICAgY29uc3QgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgIGNvbnN0IHVybFNlYXJjaFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMocGFyYW1zKS50b1N0cmluZygpO1xuICAgIGNvbnN0IHdzVXJsID0gYCR7dGhpcy5kb21haW4ucmVwbGFjZShyZSwgJ3dzJDEnKX0vY29udmVyc2F0aW9ucy9jb25uZWN0PyR7dXJsU2VhcmNoUGFyYW1zfWA7XG5cbiAgICAvLyBUaGlzIHByb21pc2Ugd2lsbCByZXNvbHZlIHdoZW4gaXQgaXMgZGlzY29ubmVjdGVkLlxuICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLnN0cmVhbUNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0Q2xpZW50V2l0aE5ldHdvcmtJbmZvcm1hdGlvbih7XG4gICAgICAgICAgZGlzY29ubmVjdGlvbkhhbmRsZXI6IHJlc29sdmUsXG4gICAgICAgICAgbmV0d29ya0luZm9ybWF0aW9uOiB0aGlzLiNuZXR3b3JrSW5mb3JtYXRpb24sXG4gICAgICAgICAgcmVxdWVzdEhhbmRsZXI6IHtcbiAgICAgICAgICAgIHByb2Nlc3NSZXF1ZXN0OiBzdHJlYW1pbmdSZXF1ZXN0ID0+IHtcbiAgICAgICAgICAgICAgLy8gSWYgYHN0cmVhbUNvbm5lY3Rpb25gIGlzIHN0aWxsIGN1cnJlbnQsIGFsbG93IGNhbGwgdG8gYHByb2Nlc3NSZXF1ZXN0KClgLCBvdGhlcndpc2UsIGlnbm9yZSBjYWxscyB0byBgcHJvY2Vzc1JlcXVlc3QoKWAuXG4gICAgICAgICAgICAgIC8vIFRoaXMgcHJldmVudHMgem9tYmllIGNvbm5lY3Rpb25zIGZyb20gc2VuZGluZyB1cyByZXF1ZXN0cy5cbiAgICAgICAgICAgICAgaWYgKGFib3J0Q29udHJvbGxlci5zaWduYWwuYWJvcnRlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHByb2Nlc3Mgc3RyZWFtaW5nIHJlcXVlc3QsIGBzdHJlYW1pbmdDb25uZWN0aW9uYCBzaG91bGQgYmUgZGlzY29ubmVjdGVkLicpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGhlU3RyZWFtSGFuZGxlci5wcm9jZXNzUmVxdWVzdChzdHJlYW1pbmdSZXF1ZXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHVybDogd3NVcmxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5xdWV1ZUFjdGl2aXRpZXMgPSB0cnVlO1xuXG4gICAgICAgIGF3YWl0IHRoaXMuc3RyZWFtQ29ubmVjdGlvbi5jb25uZWN0KCk7XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IEJGU0UuU3RyZWFtaW5nUmVxdWVzdC5jcmVhdGUoJ1BPU1QnLCAnL3YzL2RpcmVjdGxpbmUvY29udmVyc2F0aW9ucycpO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuc3RyZWFtQ29ubmVjdGlvbi5zZW5kKHJlcXVlc3QpO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlICE9PSAyMDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nvbm5lY3Rpb24gcmVzcG9uc2UgY29kZSAnICsgcmVzcG9uc2Uuc3RhdHVzQ29kZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RyZWFtcy5sZW5ndGggIT09IDEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIDEgc3RyZWFtIGJ1dCBnb3QgJyArIHJlc3BvbnNlLnN0cmVhbXMubGVuZ3RoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlU3RyaW5nID0gYXdhaXQgcmVzcG9uc2Uuc3RyZWFtc1swXS5yZWFkQXNTdHJpbmcoKTtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uID0gSlNPTi5wYXJzZShyZXNwb25zZVN0cmluZyk7XG5cbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25JZCA9IGNvbnZlcnNhdGlvbi5jb252ZXJzYXRpb25JZDtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uU3RhdHVzJC5uZXh0KENvbm5lY3Rpb25TdGF0dXMuT25saW5lKTtcblxuICAgICAgICAvLyBXYWl0IHVudGlsIERMIGNvbnN1bWVycyBoYXZlIGhhZCBhIGNoYW5jZSB0byBiZSBub3RpZmllZFxuICAgICAgICAvLyBvZiB0aGUgY29ubmVjdGlvbiBzdGF0dXMgY2hhbmdlLlxuICAgICAgICAvLyBUaGlzIGlzIHNwZWNpZmljIHRvIFJ4SlMgaW1wbGVtZW50YXRpb24gb2Ygb2JzZXJ2YWJsZSwgd2hpY2ggY2FsbGluZyBzdWJzY3JpYmUoKSBhZnRlciBuZXh0KCkgd2lsbCBzdGlsbCBnZXQgdGhlIHZhbHVlLlxuICAgICAgICBhd2FpdCB0aGlzLndhaXRVbnRpbE9ubGluZSgpO1xuXG4gICAgICAgIHRoaXMudGhlU3RyZWFtSGFuZGxlci5mbHVzaCgpO1xuICAgICAgICB0aGlzLnF1ZXVlQWN0aXZpdGllcyA9IGZhbHNlO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfSkuZmluYWxseSgoKSA9PiBhYm9ydENvbnRyb2xsZXIuYWJvcnQoKSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNvbm5lY3RXaXRoUmV0cnlBc3luYygpIHtcbiAgICAvLyBUaGlzIGZvci1sb29wIHdpbGwgYnJlYWsgd2hlbiBzb21lb25lIGNhbGwgZW5kKCkgYW5kIGl0IHdpbGwgc2lnbmFsIENvbm5lY3Rpb25TdGF0dXMuRW5kZWQuXG4gICAgZm9yICg7Oykge1xuICAgICAgLy8gQ3JlYXRlIGEgbmV3IHNpZ25hbCBhbmQgd2FpdCBmb3Igc29tZW9uZSBraWNraW5nIG9mZiB0aGUgY29ubmVjdGlvbjpcbiAgICAgIC8vIC0gc3Vic2NyaWJlIHRvIGFjdGl2aXR5JCwgb3I7XG4gICAgICAvLyAtIHJldHJpZXMgZXhoYXVzdGVkIChGYWlsZWRUb0Nvbm5lY3QpLCB0aGVuLCBzb21lb25lIGNhbGwgcmVjb25uZWN0KClcbiAgICAgIGF3YWl0ICh0aGlzLmNvbm5lY3REZWZlcnJlZCA9IGNyZWF0ZURlZmVycmVkKCkpLnByb21pc2U7XG5cbiAgICAgIGxldCBudW1SZXRyaWVzID0gTUFYX1JFVFJZX0NPVU5UO1xuXG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0dXMkLm5leHQoQ29ubmVjdGlvblN0YXR1cy5Db25uZWN0aW5nKTtcblxuICAgICAgd2hpbGUgKG51bVJldHJpZXMgPiAwKSB7XG4gICAgICAgIG51bVJldHJpZXMtLTtcblxuICAgICAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBUaGlzIHByb21pc2Ugd2lsbCByZWplY3QvcmVzb2x2ZSB3aGVuIGRpc2Nvbm5lY3RlZC5cbiAgICAgICAgICBhd2FpdCB0aGlzLmNvbm5lY3RBc3luYygpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBzb21lb25lIGNhbGwgZW5kKCkgdG8gYnJlYWsgdGhlIGNvbm5lY3Rpb24sIHdlIHdpbGwgbmV2ZXIgbGlzdGVuIHRvIGFueSByZWNvbm5lY3QoKS5cbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvblN0YXR1cyQuZ2V0VmFsdWUoKSA9PT0gQ29ubmVjdGlvblN0YXR1cy5FbmRlZCkge1xuICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIG9ubHkgcGxhY2UgdGhlIGxvb3AgaW4gdGhpcyBmdW5jdGlvbiB3aWxsIGJlIGJyb2tlLlxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBkb24ndCBzaWduYWwgQ29ubmVjdGlvblN0YXR1cy5Db25uZWN0aW5nIHR3aWNlIG9yIG1vcmUgd2l0aG91dCBhbiBhY3R1YWwgY29ubmVjdGlvbi5cbiAgICAgICAgLy8gU3Vic2VxdWVudCByZXRyaWVzIHNob3VsZCBiZSB0cmFuc3BhcmVudC5cbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvblN0YXR1cyQuZ2V0VmFsdWUoKSAhPT0gQ29ubmVjdGlvblN0YXR1cy5Db25uZWN0aW5nKSB7XG4gICAgICAgICAgdGhpcy5jb25uZWN0aW9uU3RhdHVzJC5uZXh0KENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGluZyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBjb25uZWN0aW9uIGxhc3RlZCBmb3IgbW9yZSB0aGFuIGEgbWludXRlLCB0aGUgcHJldmlvdXMgY29ubmVjdGlvbiBpcyBnb29kLCB3aGljaCBtZWFuczpcbiAgICAgICAgLy8gLSB3ZSBzaG91bGQgcmVzZXQgdGhlIHJldHJ5IGNvdW50ZXIsIGFuZDtcbiAgICAgICAgLy8gLSB3ZSBzaG91bGQgcmVjb25uZWN0IGltbWVkaWF0ZWx5LlxuICAgICAgICBpZiAoNjAwMDAgPCBEYXRlLm5vdygpIC0gc3RhcnQpIHtcbiAgICAgICAgICBudW1SZXRyaWVzID0gTUFYX1JFVFJZX0NPVU5UO1xuICAgICAgICB9IGVsc2UgaWYgKG51bVJldHJpZXMgPiAwKSB7XG4gICAgICAgICAgLy8gU2xlZXAgb25seSBpZiB3ZSBhcmUgZG9pbmcgcmV0cnkuIE90aGVyd2lzZSwgd2UgYXJlIGdvaW5nIHRvIGJyZWFrIHRoZSBsb29wIGFuZCBzaWduYWwgRmFpbGVkVG9Db25uZWN0LlxuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCB0aGlzLmdldFJldHJ5RGVsYXkoKSkpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRPRE86IFtURVNUXSBNYWtlIHN1cmUgRmFpbGVkVG9Db25uZWN0IGlzIHJlcG9ydGVkIGltbWVkaWF0ZWx5IGFmdGVyIGxhc3QgZGlzY29ubmVjdGlvbiwgc2hvdWxkIGJlIG5vIGdldFJldHJ5RGVsYXkoKS5cbiAgICAgIC8vIEZhaWxlZCB0byByZWNvbm5lY3QgYWZ0ZXIgbXVsdGlwbGUgcmV0cmllcy5cbiAgICAgIHRoaXMuY29ubmVjdGlvblN0YXR1cyQubmV4dChDb25uZWN0aW9uU3RhdHVzLkZhaWxlZFRvQ29ubmVjdCk7XG4gICAgfVxuXG4gICAgLy8gTm90ZTogTm8gY29kZSB3aWxsIGhpdCB0aGlzIGxpbmUuXG4gIH1cblxuICAvLyBSZXR1cm5zIHRoZSBkZWxheSBkdXJhdGlvbiBpbiBtaWxsaXNlY29uZHNcbiAgcHJpdmF0ZSBnZXRSZXRyeURlbGF5KCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKDMwMDAgKyBNYXRoLnJhbmRvbSgpICogMTIwMDApO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUEsSUFBQUEsZ0JBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLE9BQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLFdBQUEsR0FBQUYsT0FBQTtBQUVBLElBQUFHLElBQUEsR0FBQUMsdUJBQUEsQ0FBQUosT0FBQTtBQUNBLElBQUFLLGVBQUEsR0FBQUMsc0JBQUEsQ0FBQU4sT0FBQTtBQUNBLElBQUFPLFdBQUEsR0FBQUQsc0JBQUEsQ0FBQU4sT0FBQTtBQUVBLElBQUFRLFdBQUEsR0FBQVIsT0FBQTtBQUNBLElBQUFTLHNDQUFBLEdBQUFILHNCQUFBLENBQUFOLE9BQUE7QUFBc0csSUFBQVUsU0FBQSxvQkFYdEc7QUFBQSxTQUFBQyx5QkFBQUMsV0FBQSxlQUFBQyxPQUFBLGtDQUFBQyxpQkFBQSxPQUFBRCxPQUFBLFFBQUFFLGdCQUFBLE9BQUFGLE9BQUEsWUFBQUYsd0JBQUEsWUFBQUEseUJBQUFDLFdBQUEsV0FBQUEsV0FBQSxHQUFBRyxnQkFBQSxHQUFBRCxpQkFBQSxLQUFBRixXQUFBO0FBQUEsU0FBQVIsd0JBQUFZLEdBQUEsRUFBQUosV0FBQSxTQUFBQSxXQUFBLElBQUFJLEdBQUEsSUFBQUEsR0FBQSxDQUFBQyxVQUFBLFdBQUFELEdBQUEsUUFBQUEsR0FBQSxhQUFBRSxPQUFBLENBQUFGLEdBQUEseUJBQUFBLEdBQUEsdUNBQUFBLEdBQUEsVUFBQUcsS0FBQSxHQUFBUix3QkFBQSxDQUFBQyxXQUFBLE9BQUFPLEtBQUEsSUFBQUEsS0FBQSxDQUFBQyxHQUFBLENBQUFKLEdBQUEsWUFBQUcsS0FBQSxDQUFBRSxHQUFBLENBQUFMLEdBQUEsU0FBQU0sTUFBQSxXQUFBQyxxQkFBQSxHQUFBQyxNQUFBLENBQUFDLGNBQUEsSUFBQUQsTUFBQSxDQUFBRSx3QkFBQSxXQUFBQyxHQUFBLElBQUFYLEdBQUEsUUFBQVcsR0FBQSxrQkFBQUgsTUFBQSxDQUFBSSxTQUFBLENBQUFDLGNBQUEsQ0FBQUMsSUFBQSxDQUFBZCxHQUFBLEVBQUFXLEdBQUEsU0FBQUksSUFBQSxHQUFBUixxQkFBQSxHQUFBQyxNQUFBLENBQUFFLHdCQUFBLENBQUFWLEdBQUEsRUFBQVcsR0FBQSxjQUFBSSxJQUFBLEtBQUFBLElBQUEsQ0FBQVYsR0FBQSxJQUFBVSxJQUFBLENBQUFDLEdBQUEsS0FBQVIsTUFBQSxDQUFBQyxjQUFBLENBQUFILE1BQUEsRUFBQUssR0FBQSxFQUFBSSxJQUFBLFlBQUFULE1BQUEsQ0FBQUssR0FBQSxJQUFBWCxHQUFBLENBQUFXLEdBQUEsU0FBQUwsTUFBQSxjQUFBTixHQUFBLE1BQUFHLEtBQUEsSUFBQUEsS0FBQSxDQUFBYSxHQUFBLENBQUFoQixHQUFBLEVBQUFNLE1BQUEsWUFBQUEsTUFBQTtBQWNBLElBQU1XLG1CQUFtQixHQUFHLGdCQUFnQjtBQUM1QyxJQUFNQyxlQUFlLEdBQUcsQ0FBQztBQUN6QixJQUFNQyxvQkFBb0IsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUk7QUFDM0M7QUFDQTtBQUNBLElBQU1DLG9CQUFvQixHQUFHRCxvQkFBb0IsR0FBRyxDQUFDO0FBQUMsSUFnQmhERSxhQUFhO0VBTWpCLFNBQUFBLGNBQVlDLENBQXVCLEVBQUVDLEVBQWdDLEVBQUVDLEVBQWlCLEVBQUU7SUFBQSxJQUFBQyxnQkFBQSxtQkFBQUosYUFBQTtJQUFBLElBQUFLLGdCQUFBLG9DQUZqRCxFQUFFO0lBR3pDLElBQUksQ0FBQ0MsVUFBVSxHQUFHTCxDQUFDO0lBQ25CLElBQUksQ0FBQ00saUJBQWlCLEdBQUdMLEVBQUU7SUFDM0IsSUFBSSxDQUFDTSxXQUFXLEdBQUdMLEVBQUU7RUFDdkI7RUFBQyxJQUFBTSxhQUFBLGFBQUFULGFBQUE7SUFBQVYsR0FBQTtJQUFBb0IsS0FBQSxFQUVELFNBQUFDLGNBQXFCVixDQUF1QixFQUFFO01BQzVDLElBQUksQ0FBQ0ssVUFBVSxHQUFHTCxDQUFDO0lBQ3JCO0VBQUM7SUFBQVgsR0FBQTtJQUFBb0IsS0FBQTtNQUFBLElBQUFFLGVBQUEsT0FBQUMsa0JBQUEsMEJBQUFDLFlBQUEsWUFBQUMsSUFBQSxDQUVELFNBQUFDLFFBQXFCQyxPQUE2QixFQUFFQyxNQUFZO1FBQUEsSUFBQUMsT0FBQSxFQUFBQyxPQUFBLEVBQUFDLGVBQUEsRUFBQUMsV0FBQSxFQUFBQyxRQUFBLEVBQUFDLFdBQUEsRUFBQUMsTUFBQSxFQUFBQyxVQUFBLEVBQUFDLE9BQUE7UUFBQSxPQUFBYixZQUFBLFlBQUFjLElBQUEsVUFBQUMsU0FBQUMsUUFBQTtVQUFBO1lBQUEsUUFBQUEsUUFBQSxDQUFBQyxJQUFBLEdBQUFELFFBQUEsQ0FBQUUsSUFBQTtjQUFBO2dCQUN4RGIsT0FBTyxPQUFBYyxtQkFBQSxhQUFPaEIsT0FBTyxDQUFDRSxPQUFPO2dCQUM3QkMsT0FBTyxHQUFHRCxPQUFPLENBQUNlLEtBQUssQ0FBQyxDQUFDO2dCQUFBSixRQUFBLENBQUFFLElBQUE7Z0JBQUEsT0FDRFosT0FBTyxDQUFDZSxZQUFZLENBQUMsQ0FBQztjQUFBO2dCQUE5Q2QsZUFBZSxHQUFBUyxRQUFBLENBQUFNLElBQUE7Z0JBQ2ZkLFdBQVcsR0FBR2UsSUFBSSxDQUFDQyxLQUFLLENBQUNqQixlQUFlLENBQUM7Z0JBQUEsTUFFM0NDLFdBQVcsQ0FBQ2lCLFVBQVUsQ0FBQ0MsTUFBTSxLQUFLLENBQUM7a0JBQUFWLFFBQUEsQ0FBQUUsSUFBQTtrQkFBQTtnQkFBQTtnQkFDckM7Z0JBQ0EsSUFBSSxDQUFDMUIsVUFBVSxDQUFDbUMsS0FBSyxDQUFDLElBQUlDLEtBQUssQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO2dCQUFDLE9BQUFaLFFBQUEsQ0FBQWEsTUFBQSxXQUNsRTdFLElBQUksQ0FBQzhFLGlCQUFpQixDQUFDQyxNQUFNLENBQUMsR0FBRyxDQUFDO2NBQUE7Z0JBR3JDdEIsUUFBUSxHQUFHRCxXQUFXLENBQUNpQixVQUFVLENBQUMsQ0FBQyxDQUFDO2dCQUFBLE1BRXRDcEIsT0FBTyxDQUFDcUIsTUFBTSxHQUFHLENBQUM7a0JBQUFWLFFBQUEsQ0FBQUUsSUFBQTtrQkFBQTtnQkFBQTtnQkFDZFIsV0FBVyxPQUFBUyxtQkFBQSxhQUFPVixRQUFRLENBQUNDLFdBQVc7Y0FBQTtnQkFBQSxNQUdwQ0MsTUFBTSxHQUFHTixPQUFPLENBQUNlLEtBQUssQ0FBQyxDQUFDO2tCQUFBSixRQUFBLENBQUFFLElBQUE7a0JBQUE7Z0JBQUE7Z0JBQUFGLFFBQUEsQ0FBQUUsSUFBQTtnQkFBQSxPQUNMUCxNQUFNLENBQUNVLFlBQVksQ0FBQyxDQUFDO2NBQUE7Z0JBQXhDVCxVQUFVLEdBQUFJLFFBQUEsQ0FBQU0sSUFBQTtnQkFDVlQsT0FBTyxHQUFHLHlCQUF5QixHQUFHRCxVQUFVO2dCQUN0REYsV0FBVyxDQUFDc0IsSUFBSSxDQUFDO2tCQUFFQyxXQUFXLEVBQUV0QixNQUFNLENBQUNzQixXQUFXO2tCQUFFQyxVQUFVLEVBQUVyQjtnQkFBUSxDQUFDLENBQUM7Z0JBQUNHLFFBQUEsQ0FBQUUsSUFBQTtnQkFBQTtjQUFBO2dCQUc3RVQsUUFBUSxDQUFDQyxXQUFXLEdBQUdBLFdBQVc7Y0FBQztnQkFHckMsSUFBSSxJQUFJLENBQUNoQixXQUFXLENBQUMsQ0FBQyxFQUFFO2tCQUN0QixJQUFJLENBQUN5QyxhQUFhLENBQUNILElBQUksQ0FBQ3ZCLFFBQVEsQ0FBQztnQkFDbkMsQ0FBQyxNQUFNO2tCQUNMLElBQUksQ0FBQ2pCLFVBQVUsQ0FBQzBCLElBQUksQ0FBQ1QsUUFBUSxDQUFDO2dCQUNoQztnQkFBQyxPQUFBTyxRQUFBLENBQUFhLE1BQUEsV0FFTTdFLElBQUksQ0FBQzhFLGlCQUFpQixDQUFDQyxNQUFNLENBQUMsR0FBRyxDQUFDO2NBQUE7Y0FBQTtnQkFBQSxPQUFBZixRQUFBLENBQUFvQixJQUFBO1lBQUE7VUFBQTtRQUFBLEdBQUFsQyxPQUFBO01BQUEsQ0FDMUM7TUFBQSxTQUFBbUMsZUFBQUMsRUFBQSxFQUFBQyxHQUFBO1FBQUEsT0FBQXpDLGVBQUEsQ0FBQTBDLEtBQUEsT0FBQUMsU0FBQTtNQUFBO01BQUEsT0FBQUosY0FBQTtJQUFBO0VBQUE7SUFBQTdELEdBQUE7SUFBQW9CLEtBQUEsRUFFRCxTQUFBOEMsTUFBQSxFQUFlO01BQUEsSUFBQUMsS0FBQTtNQUNiLElBQUksQ0FBQ2xELGlCQUFpQixDQUFDbUQsU0FBUyxDQUFDLFlBQU0sQ0FBQyxDQUFDLENBQUM7TUFDMUMsSUFBSSxDQUFDVCxhQUFhLENBQUNVLE9BQU8sQ0FBQyxVQUFBQyxDQUFDO1FBQUEsT0FBSUgsS0FBSSxDQUFDbkQsVUFBVSxDQUFDMEIsSUFBSSxDQUFDNEIsQ0FBQyxDQUFDO01BQUEsRUFBQztNQUN4RCxJQUFJLENBQUNYLGFBQWEsR0FBRyxFQUFFO0lBQ3pCO0VBQUM7SUFBQTNELEdBQUE7SUFBQW9CLEtBQUEsRUFFRCxTQUFBbUQsSUFBQSxFQUFhO01BQ1gsSUFBSSxDQUFDdkQsVUFBVSxDQUFDd0QsUUFBUSxDQUFDLENBQUM7SUFDNUI7RUFBQztFQUFBLE9BQUE5RCxhQUFBO0FBQUE7QUFBQSxJQUFBK0QsbUJBQUEsb0JBQUF2RixPQUFBO0FBQUEsSUFHVXdGLG1CQUFtQjtFQW1COUIsU0FBQUEsb0JBQVlDLE9BQW1DLEVBQUU7SUFBQSxJQUFBQyxNQUFBO0lBQUEsSUFBQTlELGdCQUFBLG1CQUFBNEQsbUJBQUE7SUFBQSxJQUFBM0QsZ0JBQUEsd0NBbEJ0QixJQUFJOEQsZ0NBQWUsQ0FBQ0MsNEJBQWdCLENBQUNDLGFBQWEsQ0FBQztJQUFBLElBQUFoRSxnQkFBQSxnQ0FjMUQsRUFBRTtJQUFBMEQsbUJBQUEsQ0FBQXBFLEdBQUE7TUFBQTJFLFFBQUE7TUFBQTVELEtBQUE7SUFBQTtJQUtwQjtJQUNBLElBQU02RCxrQkFBa0IsR0FBR04sT0FBTyxhQUFQQSxPQUFPLHVCQUFQQSxPQUFPLENBQUVNLGtCQUFrQjtJQUV0RCxJQUNFLE9BQU9BLGtCQUFrQixLQUFLLFdBQVcsSUFDeEMsT0FBT0Esa0JBQWtCLENBQUNDLGdCQUFnQixLQUFLLFVBQVUsSUFDeEQsT0FBT0Qsa0JBQWtCLENBQUNFLG1CQUFtQixLQUFLLFVBQVUsSUFDNUQsT0FBT0Ysa0JBQWtCLENBQUNHLElBQUksS0FBSyxRQUFTLEVBQzlDO01BQ0EsSUFBQUMsc0JBQUEsaUJBQUksRUFBQVosbUJBQUEsRUFBdUJRLGtCQUFrQjtJQUMvQyxDQUFDLE1BQU07TUFDTEssT0FBTyxDQUFDQyxJQUFJLENBQ1YsNExBQ0YsQ0FBQztJQUNIO0lBRUEsSUFBSSxDQUFDQyxLQUFLLEdBQUdiLE9BQU8sQ0FBQ2EsS0FBSztJQUUxQixJQUFJLENBQUNDLFlBQVksQ0FBQyxDQUFDLFNBQU0sQ0FBQyxZQUFNO01BQzlCYixNQUFJLENBQUMzRCxpQkFBaUIsQ0FBQ3lCLElBQUksQ0FBQ29DLDRCQUFnQixDQUFDWSxZQUFZLENBQUM7SUFDNUQsQ0FBQyxDQUFDO0lBRUYsSUFBSSxDQUFDQyxNQUFNLEdBQUdoQixPQUFPLENBQUNnQixNQUFNO0lBRTVCLElBQUloQixPQUFPLENBQUNpQixjQUFjLEVBQUU7TUFDMUIsSUFBSSxDQUFDQSxjQUFjLEdBQUdqQixPQUFPLENBQUNpQixjQUFjO0lBQzlDO0lBRUEsSUFBSSxDQUFDQyxTQUFTLEdBQUcsSUFBSSxDQUFDQyxXQUFXLENBQUNuQixPQUFPLENBQUNvQixRQUFRLENBQUM7SUFFbkQsSUFBSSxDQUFDQyxlQUFlLEdBQUcsSUFBSTtJQUMzQixJQUFJLENBQUNDLFNBQVMsR0FBR0Msc0JBQVUsQ0FBQzNDLE1BQU07TUFBQSxJQUFBNEMsSUFBQSxPQUFBNUUsa0JBQUEsMEJBQUFDLFlBQUEsWUFBQUMsSUFBQSxDQUFDLFNBQUEyRSxTQUFPcEYsVUFBZ0M7UUFBQSxPQUFBUSxZQUFBLFlBQUFjLElBQUEsVUFBQStELFVBQUFDLFNBQUE7VUFBQTtZQUFBLFFBQUFBLFNBQUEsQ0FBQTdELElBQUEsR0FBQTZELFNBQUEsQ0FBQTVELElBQUE7Y0FBQTtnQkFDeEVrQyxNQUFJLENBQUMyQixrQkFBa0IsR0FBR3ZGLFVBQVU7Z0JBQ3BDNEQsTUFBSSxDQUFDNEIsZ0JBQWdCLEdBQUcsSUFBSTlGLGFBQWEsQ0FBQ00sVUFBVSxFQUFFNEQsTUFBSSxDQUFDM0QsaUJBQWlCLEVBQUU7a0JBQUEsT0FBTTJELE1BQUksQ0FBQ29CLGVBQWU7Z0JBQUEsRUFBQzs7Z0JBRXpHO2dCQUNBcEIsTUFBSSxDQUFDNkIsZUFBZSxDQUFDQyxPQUFPLENBQUMsQ0FBQztjQUFDO2NBQUE7Z0JBQUEsT0FBQUosU0FBQSxDQUFBMUMsSUFBQTtZQUFBO1VBQUE7UUFBQSxHQUFBd0MsUUFBQTtNQUFBLENBQ2hDO01BQUEsaUJBQUFPLEdBQUE7UUFBQSxPQUFBUixJQUFBLENBQUFuQyxLQUFBLE9BQUFDLFNBQUE7TUFBQTtJQUFBLElBQUMsQ0FBQzJDLEtBQUssQ0FBQyxDQUFDOztJQUVWO0lBQ0EsSUFBSSxDQUFDQyxxQkFBcUIsQ0FBQyxDQUFDO0VBQzlCO0VBQUMsSUFBQTFGLGFBQUEsYUFBQXVELG1CQUFBO0lBQUExRSxHQUFBO0lBQUFvQixLQUFBLEVBRUQsU0FBQTBGLFVBQUFDLEtBQUEsRUFBMEQ7TUFBQSxJQUF2Q25CLGNBQWMsR0FBQW1CLEtBQUEsQ0FBZG5CLGNBQWM7UUFBRUosS0FBSyxHQUFBdUIsS0FBQSxDQUFMdkIsS0FBSztNQUN0QyxJQUFJLElBQUksQ0FBQ3ZFLGlCQUFpQixDQUFDK0YsUUFBUSxDQUFDLENBQUMsS0FBS2xDLDRCQUFnQixDQUFDbUMsS0FBSyxFQUFFO1FBQ2hFLE1BQU0sSUFBSTdELEtBQUssQ0FBQyx1QkFBdUIsQ0FBQztNQUMxQztNQUVBLElBQUksQ0FBQ3dDLGNBQWMsR0FBR0EsY0FBYztNQUNwQyxJQUFJLENBQUNKLEtBQUssR0FBR0EsS0FBSztNQUVsQixJQUFJLENBQUNpQixlQUFlLENBQUNDLE9BQU8sQ0FBQyxDQUFDO0lBQ2hDO0VBQUM7SUFBQTFHLEdBQUE7SUFBQW9CLEtBQUEsRUFFRCxTQUFBbUQsSUFBQSxFQUFNO01BQ0o7TUFDQSxJQUFJLENBQUNnQyxrQkFBa0IsQ0FBQy9CLFFBQVEsQ0FBQyxDQUFDO01BRWxDLElBQUksQ0FBQ3ZELGlCQUFpQixDQUFDeUIsSUFBSSxDQUFDb0MsNEJBQWdCLENBQUNtQyxLQUFLLENBQUM7TUFDbkQsSUFBSSxDQUFDaEcsaUJBQWlCLENBQUN1RCxRQUFRLENBQUMsQ0FBQztNQUVqQyxJQUFJLENBQUMwQyxnQkFBZ0IsQ0FBQ0MsVUFBVSxDQUFDLENBQUM7SUFDcEM7RUFBQztJQUFBbkgsR0FBQTtJQUFBb0IsS0FBQSxFQUVELFNBQUFnRyxjQUFBLEVBQXdCO01BQ3RCLE9BQU87UUFDTEMsYUFBYSxZQUFBQyxNQUFBLENBQVksSUFBSSxDQUFDOUIsS0FBSyxDQUFFO1FBQ3JDLGdCQUFnQixFQUFFLElBQUksQ0FBQ0s7TUFDekIsQ0FBQztJQUNIO0VBQUM7SUFBQTdGLEdBQUE7SUFBQW9CLEtBQUEsRUFFRCxTQUFBMEUsWUFBQSxFQUFzRDtNQUFBLElBQWxDeUIsV0FBbUIsR0FBQXRELFNBQUEsQ0FBQWYsTUFBQSxRQUFBZSxTQUFBLFFBQUF1RCxTQUFBLEdBQUF2RCxTQUFBLE1BQUcsRUFBRTtNQUMxQyxJQUFJd0QsV0FBVyxHQUFHLHFCQUFxQjtNQUV2QyxJQUFJRixXQUFXLEVBQUU7UUFDZkUsV0FBVyxTQUFBSCxNQUFBLENBQVNDLFdBQVcsQ0FBRTtNQUNuQztNQUVBLFVBQUFELE1BQUEsQ0FBVWhILG1CQUFtQixRQUFBZ0gsTUFBQSxDQUFLRyxXQUFXO0lBQy9DO0VBQUM7SUFBQXpILEdBQUE7SUFBQW9CLEtBQUE7TUFBQSxJQUFBc0csYUFBQSxPQUFBbkcsa0JBQUEsMEJBQUFDLFlBQUEsWUFBQUMsSUFBQSxDQUVELFNBQUFrRyxTQUFBO1FBQUEsSUFBQUMsU0FBQTtVQUFBQyxVQUFBO1VBQUFDLGdCQUFBO1VBQUFDLEdBQUE7VUFBQUMsZUFBQTtVQUFBeEMsS0FBQTtVQUFBeUMsTUFBQSxHQUFBaEUsU0FBQTtRQUFBLE9BQUF6QyxZQUFBLFlBQUFjLElBQUEsVUFBQTRGLFVBQUFDLFNBQUE7VUFBQTtZQUFBLFFBQUFBLFNBQUEsQ0FBQTFGLElBQUEsR0FBQTBGLFNBQUEsQ0FBQXpGLElBQUE7Y0FBQTtnQkFBMkJrRixTQUFTLEdBQUFLLE1BQUEsQ0FBQS9FLE1BQUEsUUFBQStFLE1BQUEsUUFBQVQsU0FBQSxHQUFBUyxNQUFBLE1BQUcsSUFBSTtnQkFBRUosVUFBVSxHQUFBSSxNQUFBLENBQUEvRSxNQUFBLFFBQUErRSxNQUFBLFFBQUFULFNBQUEsR0FBQVMsTUFBQSxNQUFHLENBQUM7Z0JBQUFFLFNBQUEsQ0FBQXpGLElBQUE7Z0JBQUEsT0FDbkQsSUFBSSxDQUFDMEYsZUFBZSxDQUFDLENBQUM7Y0FBQTtnQkFFeEJOLGdCQUFnQixHQUFHLENBQUM7Y0FBQTtnQkFBQSxNQUNqQkEsZ0JBQWdCLEdBQUd2SCxlQUFlO2tCQUFBNEgsU0FBQSxDQUFBekYsSUFBQTtrQkFBQTtnQkFBQTtnQkFDdkNvRixnQkFBZ0IsRUFBRTtnQkFBQ0ssU0FBQSxDQUFBekYsSUFBQTtnQkFBQSxPQUNiLElBQUkyRixPQUFPLENBQUMsVUFBQUMsQ0FBQztrQkFBQSxPQUFJQyxVQUFVLENBQUNELENBQUMsRUFBRTdILG9CQUFvQixDQUFDO2dCQUFBLEVBQUM7Y0FBQTtnQkFBQTBILFNBQUEsQ0FBQTFGLElBQUE7Z0JBQUEwRixTQUFBLENBQUF6RixJQUFBO2dCQUFBLE9BRXZDLElBQUE4RixzQkFBSyxLQUFBbEIsTUFBQSxDQUFJLElBQUksQ0FBQzNCLE1BQU0sc0JBQW1CO2tCQUFFOEMsTUFBTSxFQUFFLE1BQU07a0JBQUVDLE9BQU8sRUFBRSxJQUFJLENBQUN0QixhQUFhLENBQUM7Z0JBQUUsQ0FBQyxDQUFDO2NBQUE7Z0JBQXJHVyxHQUFHLEdBQUFJLFNBQUEsQ0FBQXJGLElBQUE7Z0JBQUEsS0FDTGlGLEdBQUcsQ0FBQ1ksRUFBRTtrQkFBQVIsU0FBQSxDQUFBekYsSUFBQTtrQkFBQTtnQkFBQTtnQkFDUm9GLGdCQUFnQixHQUFHLENBQUM7Z0JBQUNLLFNBQUEsQ0FBQXpGLElBQUE7Z0JBQUEsT0FDR3FGLEdBQUcsQ0FBQ2EsSUFBSSxDQUFDLENBQUM7Y0FBQTtnQkFBQVosZUFBQSxHQUFBRyxTQUFBLENBQUFyRixJQUFBO2dCQUExQjBDLEtBQUssR0FBQXdDLGVBQUEsQ0FBTHhDLEtBQUs7Z0JBQ2IsSUFBSSxDQUFDQSxLQUFLLEdBQUdBLEtBQUs7Z0JBQUMyQyxTQUFBLENBQUF6RixJQUFBO2dCQUFBO2NBQUE7Z0JBRW5CLElBQUlxRixHQUFHLENBQUNjLE1BQU0sS0FBSyxHQUFHLElBQUlkLEdBQUcsQ0FBQ2MsTUFBTSxLQUFLLEdBQUcsRUFBRTtrQkFDNUN2RCxPQUFPLENBQUNuQyxLQUFLLDRDQUFBbUUsTUFBQSxDQUE0Q1MsR0FBRyxDQUFDYyxNQUFNLE9BQUF2QixNQUFBLENBQUlTLEdBQUcsQ0FBQ2UsVUFBVSxDQUFFLENBQUM7a0JBQ3hGLElBQUksQ0FBQzVCLGdCQUFnQixDQUFDQyxVQUFVLENBQUMsQ0FBQztnQkFDcEMsQ0FBQyxNQUFNO2tCQUNMN0IsT0FBTyxDQUFDQyxJQUFJLHFCQUFBK0IsTUFBQSxDQUFxQlEsZ0JBQWdCLGVBQUFSLE1BQUEsQ0FBWVMsR0FBRyxDQUFDYyxNQUFNLE9BQUF2QixNQUFBLENBQUlTLEdBQUcsQ0FBQ2UsVUFBVSxDQUFFLENBQUM7Z0JBQzlGO2NBQUM7Z0JBQUFYLFNBQUEsQ0FBQXpGLElBQUE7Z0JBQUE7Y0FBQTtnQkFBQXlGLFNBQUEsQ0FBQTFGLElBQUE7Z0JBQUEwRixTQUFBLENBQUFZLEVBQUEsR0FBQVosU0FBQTtnQkFHSDdDLE9BQU8sQ0FBQ0MsSUFBSSxxQkFBQStCLE1BQUEsQ0FBcUJRLGdCQUFnQiwyQkFBQVIsTUFBQSxDQUFBYSxTQUFBLENBQUFZLEVBQUEsQ0FBMkIsQ0FBQztjQUFDO2dCQUFBWixTQUFBLENBQUF6RixJQUFBO2dCQUFBO2NBQUE7Z0JBSWxGNEMsT0FBTyxDQUFDbkMsS0FBSyxDQUFDLG1CQUFtQixDQUFDO2dCQUNsQyxJQUFJLENBQUMrRCxnQkFBZ0IsQ0FBQ0MsVUFBVSxDQUFDLENBQUM7Y0FBQztjQUFBO2dCQUFBLE9BQUFnQixTQUFBLENBQUF2RSxJQUFBO1lBQUE7VUFBQTtRQUFBLEdBQUErRCxRQUFBO01BQUEsQ0FDcEM7TUFBQSxTQUFBbEMsYUFBQTtRQUFBLE9BQUFpQyxhQUFBLENBQUExRCxLQUFBLE9BQUFDLFNBQUE7TUFBQTtNQUFBLE9BQUF3QixZQUFBO0lBQUE7RUFBQTtJQUFBekYsR0FBQTtJQUFBb0IsS0FBQSxFQUVELFNBQUE0SCxhQUFhL0csUUFBa0IsRUFBRTtNQUFBLElBQUFnSCxNQUFBO01BQy9CLElBQ0UsSUFBSSxDQUFDaEksaUJBQWlCLENBQUNHLEtBQUssS0FBSzBELDRCQUFnQixDQUFDbUMsS0FBSyxJQUN2RCxJQUFJLENBQUNoRyxpQkFBaUIsQ0FBQ0csS0FBSyxLQUFLMEQsNEJBQWdCLENBQUNvRSxlQUFlLEVBQ2pFO1FBQ0EsT0FBT2hELHNCQUFVLFNBQU0sQ0FBQyxJQUFJOUMsS0FBSyxDQUFDLHNCQUFzQixDQUFDLENBQUM7TUFDNUQ7TUFFQSxJQUFJbkIsUUFBUSxDQUFDbUQsSUFBSSxLQUFLLFNBQVMsSUFBSW5ELFFBQVEsQ0FBQ0MsV0FBVyxJQUFJRCxRQUFRLENBQUNDLFdBQVcsQ0FBQ2dCLE1BQU0sR0FBRyxDQUFDLEVBQUU7UUFDMUYsT0FBTyxJQUFJLENBQUNpRywwQkFBMEIsQ0FBQ2xILFFBQVEsQ0FBQztNQUNsRDtNQUVBLElBQU1tSCxLQUFLLEdBQUdsRCxzQkFBVSxDQUFDM0MsTUFBTTtRQUFBLElBQUE4RixLQUFBLE9BQUE5SCxrQkFBQSwwQkFBQUMsWUFBQSxZQUFBQyxJQUFBLENBQUMsU0FBQTZILFNBQU10SSxVQUFVO1VBQUEsSUFBQVcsT0FBQSxFQUFBNEgsSUFBQSxFQUFBQyxlQUFBLEVBQUFDLFFBQUEsRUFBQUMsV0FBQSxFQUFBQyxFQUFBO1VBQUEsT0FBQW5JLFlBQUEsWUFBQWMsSUFBQSxVQUFBc0gsVUFBQUMsU0FBQTtZQUFBO2NBQUEsUUFBQUEsU0FBQSxDQUFBcEgsSUFBQSxHQUFBb0gsU0FBQSxDQUFBbkgsSUFBQTtnQkFBQTtrQkFDeENmLE9BQU8sR0FBR25ELElBQUksQ0FBQ3NMLGdCQUFnQixDQUFDdkcsTUFBTSxDQUMxQyxNQUFNLEVBQ04sK0JBQStCLEdBQUcwRixNQUFJLENBQUNyRCxjQUFjLEdBQUcsYUFDMUQsQ0FBQztrQkFDRGpFLE9BQU8sQ0FBQ29JLE9BQU8sQ0FBQ2hILElBQUksQ0FBQ2lILFNBQVMsQ0FBQy9ILFFBQVEsQ0FBQyxDQUFDO2tCQUFDNEgsU0FBQSxDQUFBcEgsSUFBQTtrQkFBQW9ILFNBQUEsQ0FBQW5ILElBQUE7a0JBQUEsT0FHckJ1RyxNQUFJLENBQUMvQixnQkFBZ0IsQ0FBQytDLElBQUksQ0FBQ3RJLE9BQU8sQ0FBQztnQkFBQTtrQkFBaEQ0SCxJQUFJLEdBQUFNLFNBQUEsQ0FBQS9HLElBQUE7a0JBQUEsTUFDTnlHLElBQUksQ0FBQ1csVUFBVSxLQUFLLEdBQUc7b0JBQUFMLFNBQUEsQ0FBQW5ILElBQUE7b0JBQUE7a0JBQUE7a0JBQUEsTUFBUSxJQUFJVSxLQUFLLENBQUMsd0JBQXdCLEdBQUdtRyxJQUFJLENBQUNXLFVBQVUsQ0FBQztnQkFBQTtrQkFDbEZWLGVBQWUsR0FBR0QsSUFBSSxDQUFDMUgsT0FBTyxDQUFDcUIsTUFBTTtrQkFBQSxNQUN2Q3NHLGVBQWUsS0FBSyxDQUFDO29CQUFBSyxTQUFBLENBQUFuSCxJQUFBO29CQUFBO2tCQUFBO2tCQUFBLE1BQVEsSUFBSVUsS0FBSyxDQUFDLDhCQUE4QixHQUFHb0csZUFBZSxDQUFDO2dCQUFBO2tCQUFBSyxTQUFBLENBQUFuSCxJQUFBO2tCQUFBLE9BQ3JFNkcsSUFBSSxDQUFDMUgsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDZ0IsWUFBWSxDQUFDLENBQUM7Z0JBQUE7a0JBQS9DNEcsUUFBUSxHQUFBSSxTQUFBLENBQUEvRyxJQUFBO2tCQUFBNEcsV0FBQSxHQUNLM0csSUFBSSxDQUFDQyxLQUFLLENBQUN5RyxRQUFRLENBQUMsRUFBM0JFLEVBQUUsR0FBQUQsV0FBQSxDQUFOUyxFQUFFO2tCQUNWbkosVUFBVSxDQUFDMEIsSUFBSSxDQUFDaUgsRUFBRSxDQUFDO2tCQUFDLE9BQUFFLFNBQUEsQ0FBQXhHLE1BQUEsV0FDYnJDLFVBQVUsQ0FBQ3dELFFBQVEsQ0FBQyxDQUFDO2dCQUFBO2tCQUFBcUYsU0FBQSxDQUFBcEgsSUFBQTtrQkFBQW9ILFNBQUEsQ0FBQWQsRUFBQSxHQUFBYyxTQUFBO2tCQUU1QjtrQkFDQTtrQkFDQTtrQkFDQXZFLE9BQU8sQ0FBQ0MsSUFBSSxDQUFBc0UsU0FBQSxDQUFBZCxFQUFFLENBQUM7a0JBQ2ZFLE1BQUksQ0FBQy9CLGdCQUFnQixDQUFDQyxVQUFVLENBQUMsQ0FBQztrQkFBQyxPQUFBMEMsU0FBQSxDQUFBeEcsTUFBQSxXQUM1QnJDLFVBQVUsQ0FBQ21DLEtBQUssQ0FBQTBHLFNBQUEsQ0FBQWQsRUFBRSxDQUFDO2dCQUFBO2dCQUFBO2tCQUFBLE9BQUFjLFNBQUEsQ0FBQWpHLElBQUE7Y0FBQTtZQUFBO1VBQUEsR0FBQTBGLFFBQUE7UUFBQSxDQUU3QjtRQUFBLGlCQUFBYyxHQUFBO1VBQUEsT0FBQWYsS0FBQSxDQUFBckYsS0FBQSxPQUFBQyxTQUFBO1FBQUE7TUFBQSxJQUFDO01BQ0YsT0FBT21GLEtBQUs7SUFDZDtFQUFDO0lBQUFwSixHQUFBO0lBQUFvQixLQUFBLEVBRUQsU0FBQStILDJCQUFtQ2tCLE9BQWdCLEVBQUU7TUFBQSxJQUFBQyxNQUFBO01BQ25ELElBQVFwSSxXQUFXLEdBQW1DbUksT0FBTyxDQUFyRG5JLFdBQVc7UUFBS3FJLHlCQUF5QixPQUFBQyx5QkFBQSxhQUFLSCxPQUFPLEVBQUF0TCxTQUFBO01BRTdELE9BQU9tSCxzQkFBVSxDQUFDM0MsTUFBTSxDQUFDLFVBQUF2QyxVQUFVLEVBQUk7UUFDckMsSUFBTXlKLGVBQWUsR0FBRyxFQUFFO1FBQzFCLElBQUFsSixrQkFBQSwwQkFBQUMsWUFBQSxZQUFBQyxJQUFBLENBQUMsU0FBQWlKLFNBQUE7VUFBQSxJQUFBQyxZQUFBLEVBQUFDLEdBQUEsRUFBQWpKLE9BQUEsRUFBQWtKLGNBQUEsRUFBQXRCLElBQUEsRUFBQXVCLG9CQUFBLEVBQUFuQixFQUFBO1VBQUEsT0FBQW5JLFlBQUEsWUFBQWMsSUFBQSxVQUFBeUksVUFBQUMsU0FBQTtZQUFBO2NBQUEsUUFBQUEsU0FBQSxDQUFBdkksSUFBQSxHQUFBdUksU0FBQSxDQUFBdEksSUFBQTtnQkFBQTtrQkFBQXNJLFNBQUEsQ0FBQXZJLElBQUE7a0JBQUF1SSxTQUFBLENBQUF0SSxJQUFBO2tCQUFBLE9BRThCMkYsT0FBTyxDQUFDNEMsR0FBRyxDQUNwQy9JLFdBQVcsQ0FBQ2dKLEdBQUc7b0JBQUEsSUFBQUMsS0FBQSxPQUFBNUosa0JBQUEsMEJBQUFDLFlBQUEsWUFBQUMsSUFBQSxDQUFDLFNBQUEySixTQUFNaEosVUFBVTtzQkFBQSxJQUFBaUosS0FBQSxFQUFBdEQsR0FBQTtzQkFBQSxPQUFBdkcsWUFBQSxZQUFBYyxJQUFBLFVBQUFnSixVQUFBQyxTQUFBO3dCQUFBOzBCQUFBLFFBQUFBLFNBQUEsQ0FBQTlJLElBQUEsR0FBQThJLFNBQUEsQ0FBQTdJLElBQUE7NEJBQUE7OEJBQ3hCMkksS0FBSyxHQUFHakosVUFBVTs4QkFBQW1KLFNBQUEsQ0FBQTdJLElBQUE7OEJBQUEsT0FDTixJQUFBOEYsc0JBQUssRUFBQzZDLEtBQUssQ0FBQzNILFVBQVUsQ0FBQzs0QkFBQTs4QkFBbkNxRSxHQUFHLEdBQUF3RCxTQUFBLENBQUF6SSxJQUFBOzhCQUFBLEtBQ0xpRixHQUFHLENBQUNZLEVBQUU7Z0NBQUE0QyxTQUFBLENBQUE3SSxJQUFBO2dDQUFBOzhCQUFBOzhCQUFBNkksU0FBQSxDQUFBN0ksSUFBQTs4QkFBQSxPQUNvQnFGLEdBQUcsQ0FBQ3lELFdBQVcsQ0FBQyxDQUFDOzRCQUFBOzhCQUFBRCxTQUFBLENBQUF4QyxFQUFBLEdBQUF3QyxTQUFBLENBQUF6SSxJQUFBOzhCQUFBeUksU0FBQSxDQUFBRSxFQUFBLEdBQUVKLEtBQUs7OEJBQUEsT0FBQUUsU0FBQSxDQUFBbEksTUFBQTtnQ0FBM0NtSSxXQUFXLEVBQUFELFNBQUEsQ0FBQXhDLEVBQUE7Z0NBQTJCc0MsS0FBSyxFQUFBRSxTQUFBLENBQUFFOzhCQUFBOzRCQUFBOzhCQUFBLE1BRTlDLElBQUlySSxLQUFLLENBQUMsS0FBSyxDQUFDOzRCQUFBOzRCQUFBOzhCQUFBLE9BQUFtSSxTQUFBLENBQUEzSCxJQUFBOzBCQUFBO3dCQUFBO3NCQUFBLEdBQUF3SCxRQUFBO29CQUFBLENBRXpCO29CQUFBLGlCQUFBTSxHQUFBO3NCQUFBLE9BQUFQLEtBQUEsQ0FBQW5ILEtBQUEsT0FBQUMsU0FBQTtvQkFBQTtrQkFBQSxJQUNILENBQUM7Z0JBQUE7a0JBVkswRyxZQUFZLEdBQUFLLFNBQUEsQ0FBQWxJLElBQUE7a0JBWWxCNkgsWUFBWSxDQUFDdEcsT0FBTyxDQUFDLFVBQUFzSCxLQUFBLEVBQTRCO29CQUFBLElBQXpCSCxXQUFXLEdBQUFHLEtBQUEsQ0FBWEgsV0FBVztzQkFBRUgsS0FBSyxHQUFBTSxLQUFBLENBQUxOLEtBQUs7b0JBQ3hDLElBQU1PLE1BQU0sR0FBR0MsY0FBTSxDQUFDQyxJQUFJLENBQUNOLFdBQVcsQ0FBQztvQkFDdkMsSUFBTXJKLE1BQU0sR0FBRyxJQUFJM0QsSUFBSSxDQUFDdU4sa0JBQWtCLENBQUMsQ0FBQztvQkFDNUM1SixNQUFNLENBQUM2SixLQUFLLENBQUNKLE1BQU0sQ0FBQztvQkFDcEIsSUFBTUssV0FBVyxHQUFHLElBQUl6TixJQUFJLENBQUMwTixXQUFXLENBQUM7c0JBQUU5RyxJQUFJLEVBQUVpRyxLQUFLLENBQUM1SCxXQUFXO3NCQUFFMEksYUFBYSxFQUFFUCxNQUFNLENBQUMxSTtvQkFBTyxDQUFDLEVBQUVmLE1BQU0sQ0FBQztvQkFDM0dzSSxlQUFlLENBQUNqSCxJQUFJLENBQUN5SSxXQUFXLENBQUM7a0JBQ25DLENBQUMsQ0FBQztrQkFFSXJCLEdBQUcsbUNBQUF0RCxNQUFBLENBQW1DZ0QsTUFBSSxDQUFDMUUsY0FBYyxhQUFBMEIsTUFBQSxDQUFVaUQseUJBQXlCLENBQUN1QixJQUFJLENBQUNuQyxFQUFFO2tCQUNwR2hJLE9BQU8sR0FBR25ELElBQUksQ0FBQ3NMLGdCQUFnQixDQUFDdkcsTUFBTSxDQUFDLEtBQUssRUFBRXFILEdBQUcsQ0FBQztrQkFDbERDLGNBQWMsR0FBRyxJQUFJck0sSUFBSSxDQUFDdU4sa0JBQWtCLENBQUMsQ0FBQztrQkFDcERsQixjQUFjLENBQUNtQixLQUFLLENBQUNqSixJQUFJLENBQUNpSCxTQUFTLENBQUNPLHlCQUF5QixDQUFDLEVBQUUsT0FBTyxDQUFDO2tCQUN4RTVJLE9BQU8sQ0FBQ3lLLFNBQVMsQ0FDZixJQUFJNU4sSUFBSSxDQUFDME4sV0FBVyxDQUNsQjtvQkFBRTlHLElBQUksRUFBRSxvQ0FBb0M7b0JBQUUrRyxhQUFhLEVBQUV0QixjQUFjLENBQUMzSDtrQkFBTyxDQUFDLEVBQ3BGMkgsY0FDRixDQUNGLENBQUM7a0JBQ0RKLGVBQWUsQ0FBQ3BHLE9BQU8sQ0FBQyxVQUFBZ0ksQ0FBQztvQkFBQSxPQUFJMUssT0FBTyxDQUFDeUssU0FBUyxDQUFDQyxDQUFDLENBQUM7a0JBQUEsRUFBQztrQkFBQ3JCLFNBQUEsQ0FBQXRJLElBQUE7a0JBQUEsT0FFaEM0SCxNQUFJLENBQUNwRCxnQkFBZ0IsQ0FBQytDLElBQUksQ0FBQ3RJLE9BQU8sQ0FBQztnQkFBQTtrQkFBaEQ0SCxJQUFJLEdBQUF5QixTQUFBLENBQUFsSSxJQUFBO2tCQUFBLE1BQ055RyxJQUFJLENBQUMxSCxPQUFPLElBQUkwSCxJQUFJLENBQUMxSCxPQUFPLENBQUNxQixNQUFNLEtBQUssQ0FBQztvQkFBQThILFNBQUEsQ0FBQXRJLElBQUE7b0JBQUE7a0JBQUE7a0JBQzNDMUIsVUFBVSxDQUFDbUMsS0FBSyxDQUFDLElBQUlDLEtBQUsseUJBQUFrRSxNQUFBLENBQXlCaUMsSUFBSSxDQUFDMUgsT0FBTyxDQUFDcUIsTUFBTSxDQUFFLENBQUMsQ0FBQztrQkFBQzhILFNBQUEsQ0FBQXRJLElBQUE7a0JBQUE7Z0JBQUE7a0JBQUFzSSxTQUFBLENBQUF0SSxJQUFBO2tCQUFBLE9BRWxENkcsSUFBSSxDQUFDMUgsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDeUssVUFBVSxDQUFpQixDQUFDO2dCQUFBO2tCQUFBeEIsb0JBQUEsR0FBQUUsU0FBQSxDQUFBbEksSUFBQTtrQkFBekQ2RyxFQUFFLEdBQUFtQixvQkFBQSxDQUFOWCxFQUFFO2tCQUNWbkosVUFBVSxDQUFDMEIsSUFBSSxDQUFDaUgsRUFBRSxDQUFDO2tCQUNuQjNJLFVBQVUsQ0FBQ3dELFFBQVEsQ0FBQyxDQUFDO2dCQUFDO2tCQUFBd0csU0FBQSxDQUFBdEksSUFBQTtrQkFBQTtnQkFBQTtrQkFBQXNJLFNBQUEsQ0FBQXZJLElBQUE7a0JBQUF1SSxTQUFBLENBQUFqQyxFQUFBLEdBQUFpQyxTQUFBO2tCQUd4QmhLLFVBQVUsQ0FBQ21DLEtBQUssQ0FBQTZILFNBQUEsQ0FBQWpDLEVBQUUsQ0FBQztnQkFBQztnQkFBQTtrQkFBQSxPQUFBaUMsU0FBQSxDQUFBcEgsSUFBQTtjQUFBO1lBQUE7VUFBQSxHQUFBOEcsUUFBQTtRQUFBLENBRXZCLEdBQUUsQ0FBQztNQUNOLENBQUMsQ0FBQztJQUNKO0VBQUM7SUFBQTFLLEdBQUE7SUFBQW9CLEtBQUE7TUFBQSxJQUFBbUwsZ0JBQUEsT0FBQWhMLGtCQUFBLDBCQUFBQyxZQUFBLFlBQUFDLElBQUEsQ0FFRCxTQUFBK0ssU0FBQTtRQUFBLElBQUFDLE1BQUE7UUFBQSxPQUFBakwsWUFBQSxZQUFBYyxJQUFBLFVBQUFvSyxVQUFBQyxTQUFBO1VBQUE7WUFBQSxRQUFBQSxTQUFBLENBQUFsSyxJQUFBLEdBQUFrSyxTQUFBLENBQUFqSyxJQUFBO2NBQUE7Z0JBQUEsT0FBQWlLLFNBQUEsQ0FBQXRKLE1BQUEsV0FDUyxJQUFJZ0YsT0FBTyxDQUFPLFVBQUMzQixPQUFPLEVBQUVrRyxNQUFNLEVBQUs7a0JBQzVDSCxNQUFJLENBQUN4TCxpQkFBaUIsQ0FBQ21ELFNBQVMsQ0FDOUIsVUFBQXlJLEVBQUUsRUFBSTtvQkFDSixJQUFJQSxFQUFFLEtBQUsvSCw0QkFBZ0IsQ0FBQ2dJLE1BQU0sRUFBRTtzQkFDbEMsT0FBT3BHLE9BQU8sQ0FBQyxDQUFDO29CQUNsQjtrQkFDRixDQUFDLEVBQ0QsVUFBQTJGLENBQUM7b0JBQUEsT0FBSU8sTUFBTSxDQUFDUCxDQUFDLENBQUM7a0JBQUEsQ0FDaEIsQ0FBQztnQkFDSCxDQUFDLENBQUM7Y0FBQTtjQUFBO2dCQUFBLE9BQUFNLFNBQUEsQ0FBQS9JLElBQUE7WUFBQTtVQUFBO1FBQUEsR0FBQTRJLFFBQUE7TUFBQSxDQUNIO01BQUEsU0FBQXBFLGdCQUFBO1FBQUEsT0FBQW1FLGdCQUFBLENBQUF2SSxLQUFBLE9BQUFDLFNBQUE7TUFBQTtNQUFBLE9BQUFtRSxlQUFBO0lBQUE7RUFBQTtJQUFBcEksR0FBQTtJQUFBb0IsS0FBQTtNQUFBLElBQUEyTCxhQUFBLE9BQUF4TCxrQkFBQSwwQkFBQUMsWUFBQSxZQUFBQyxJQUFBLENBRUQsU0FBQXVMLFNBQUE7UUFBQSxJQUFBQyxNQUFBO1FBQUEsSUFBQUMsRUFBQSxFQUFBQyxNQUFBLEVBQUFDLGVBQUEsRUFBQUMsZUFBQSxFQUFBQyxLQUFBO1FBQUEsT0FBQTlMLFlBQUEsWUFBQWMsSUFBQSxVQUFBaUwsVUFBQUMsU0FBQTtVQUFBO1lBQUEsUUFBQUEsU0FBQSxDQUFBL0ssSUFBQSxHQUFBK0ssU0FBQSxDQUFBOUssSUFBQTtjQUFBO2dCQUNRd0ssRUFBRSxHQUFHLElBQUlPLE1BQU0sQ0FBQyxXQUFXLENBQUM7Z0JBQUEsSUFFN0JQLEVBQUUsQ0FBQ1EsSUFBSSxDQUFDLElBQUksQ0FBQy9ILE1BQU0sQ0FBQztrQkFBQTZILFNBQUEsQ0FBQTlLLElBQUE7a0JBQUE7Z0JBQUE7Z0JBQUEsTUFDakIsc0NBQXNDO2NBQUE7Z0JBR3hDeUssTUFBTSxHQUFHO2tCQUFFM0gsS0FBSyxFQUFFLElBQUksQ0FBQ0E7Z0JBQU0sQ0FBQztnQkFFcEMsSUFBSSxJQUFJLENBQUNJLGNBQWMsRUFBRTtrQkFDdkJ1SCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxJQUFJLENBQUN2SCxjQUFjO2dCQUNoRDtnQkFFTXdILGVBQWUsR0FBRyxJQUFJTyxlQUFlLENBQUMsQ0FBQztnQkFDdkNOLGVBQWUsR0FBRyxJQUFJTyxlQUFlLENBQUNULE1BQU0sQ0FBQyxDQUFDVSxRQUFRLENBQUMsQ0FBQztnQkFDeERQLEtBQUssTUFBQWhHLE1BQUEsQ0FBTSxJQUFJLENBQUMzQixNQUFNLENBQUNtSSxPQUFPLENBQUNaLEVBQUUsRUFBRSxNQUFNLENBQUMsNkJBQUE1RixNQUFBLENBQTBCK0YsZUFBZSxHQUV6RjtnQkFBQSxPQUFBRyxTQUFBLENBQUFuSyxNQUFBLFdBQ08sSUFBSWdGLE9BQU87a0JBQUEsSUFBQTBGLEtBQUEsT0FBQXhNLGtCQUFBLDBCQUFBQyxZQUFBLFlBQUFDLElBQUEsQ0FBQyxTQUFBdU0sU0FBT3RILE9BQU8sRUFBRWtHLE1BQU07b0JBQUEsSUFBQWpMLE9BQUEsRUFBQXNNLFFBQUEsRUFBQUMsY0FBQSxFQUFBQyxZQUFBO29CQUFBLE9BQUEzTSxZQUFBLFlBQUFjLElBQUEsVUFBQThMLFVBQUFDLFNBQUE7c0JBQUE7d0JBQUEsUUFBQUEsU0FBQSxDQUFBNUwsSUFBQSxHQUFBNEwsU0FBQSxDQUFBM0wsSUFBQTswQkFBQTs0QkFBQTJMLFNBQUEsQ0FBQTVMLElBQUE7NEJBRXJDd0ssTUFBSSxDQUFDL0YsZ0JBQWdCLEdBQUcsSUFBSW9ILGlEQUFxQyxDQUFDOzhCQUNoRUMsb0JBQW9CLEVBQUU3SCxPQUFPOzhCQUM3QnpCLGtCQUFrQixNQUFBdUosc0JBQUEsYUFBRXZCLE1BQUksRUFBQXhJLG1CQUFBLENBQW9COzhCQUM1Q2dLLGNBQWMsRUFBRTtnQ0FDZDVLLGNBQWMsRUFBRSxTQUFBQSxlQUFBNkssZ0JBQWdCLEVBQUk7a0NBQ2xDO2tDQUNBO2tDQUNBLElBQUl0QixlQUFlLENBQUN1QixNQUFNLENBQUNDLE9BQU8sRUFBRTtvQ0FDbEMsTUFBTSxJQUFJeEwsS0FBSyxDQUFDLGlGQUFpRixDQUFDO2tDQUNwRztrQ0FFQSxPQUFPNkosTUFBSSxDQUFDekcsZ0JBQWdCLENBQUMzQyxjQUFjLENBQUM2SyxnQkFBZ0IsQ0FBQztnQ0FDL0Q7OEJBQ0YsQ0FBQzs4QkFDRDlELEdBQUcsRUFBRTBDOzRCQUNQLENBQUMsQ0FBQzs0QkFFRkwsTUFBSSxDQUFDakgsZUFBZSxHQUFHLElBQUk7NEJBQUNxSSxTQUFBLENBQUEzTCxJQUFBOzRCQUFBLE9BRXRCdUssTUFBSSxDQUFDL0YsZ0JBQWdCLENBQUMySCxPQUFPLENBQUMsQ0FBQzswQkFBQTs0QkFFL0JsTixPQUFPLEdBQUduRCxJQUFJLENBQUNzTCxnQkFBZ0IsQ0FBQ3ZHLE1BQU0sQ0FBQyxNQUFNLEVBQUUsOEJBQThCLENBQUM7NEJBQUE4SyxTQUFBLENBQUEzTCxJQUFBOzRCQUFBLE9BQzdEdUssTUFBSSxDQUFDL0YsZ0JBQWdCLENBQUMrQyxJQUFJLENBQUN0SSxPQUFPLENBQUM7MEJBQUE7NEJBQXBEc00sUUFBUSxHQUFBSSxTQUFBLENBQUF2TCxJQUFBOzRCQUFBLE1BRVZtTCxRQUFRLENBQUMvRCxVQUFVLEtBQUssR0FBRzs4QkFBQW1FLFNBQUEsQ0FBQTNMLElBQUE7OEJBQUE7NEJBQUE7NEJBQUEsTUFDdkIsSUFBSVUsS0FBSyxDQUFDLDJCQUEyQixHQUFHNkssUUFBUSxDQUFDL0QsVUFBVSxDQUFDOzBCQUFBOzRCQUFBLE1BR2hFK0QsUUFBUSxDQUFDcE0sT0FBTyxDQUFDcUIsTUFBTSxLQUFLLENBQUM7OEJBQUFtTCxTQUFBLENBQUEzTCxJQUFBOzhCQUFBOzRCQUFBOzRCQUFBLE1BQ3pCLElBQUlVLEtBQUssQ0FBQyw0QkFBNEIsR0FBRzZLLFFBQVEsQ0FBQ3BNLE9BQU8sQ0FBQ3FCLE1BQU0sQ0FBQzswQkFBQTs0QkFBQW1MLFNBQUEsQ0FBQTNMLElBQUE7NEJBQUEsT0FHNUN1TCxRQUFRLENBQUNwTSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUNnQixZQUFZLENBQUMsQ0FBQzswQkFBQTs0QkFBekRxTCxjQUFjLEdBQUFHLFNBQUEsQ0FBQXZMLElBQUE7NEJBQ2RxTCxZQUFZLEdBQUdwTCxJQUFJLENBQUNDLEtBQUssQ0FBQ2tMLGNBQWMsQ0FBQzs0QkFFL0NqQixNQUFJLENBQUNySCxjQUFjLEdBQUd1SSxZQUFZLENBQUN2SSxjQUFjOzRCQUNqRHFILE1BQUksQ0FBQ2hNLGlCQUFpQixDQUFDeUIsSUFBSSxDQUFDb0MsNEJBQWdCLENBQUNnSSxNQUFNLENBQUM7OzRCQUVwRDs0QkFDQTs0QkFDQTs0QkFBQXVCLFNBQUEsQ0FBQTNMLElBQUE7NEJBQUEsT0FDTXVLLE1BQUksQ0FBQzdFLGVBQWUsQ0FBQyxDQUFDOzBCQUFBOzRCQUU1QjZFLE1BQUksQ0FBQ3pHLGdCQUFnQixDQUFDdEMsS0FBSyxDQUFDLENBQUM7NEJBQzdCK0ksTUFBSSxDQUFDakgsZUFBZSxHQUFHLEtBQUs7NEJBQUNxSSxTQUFBLENBQUEzTCxJQUFBOzRCQUFBOzBCQUFBOzRCQUFBMkwsU0FBQSxDQUFBNUwsSUFBQTs0QkFBQTRMLFNBQUEsQ0FBQXRGLEVBQUEsR0FBQXNGLFNBQUE7NEJBRTdCekIsTUFBTSxDQUFBeUIsU0FBQSxDQUFBdEYsRUFBRSxDQUFDOzBCQUFDOzBCQUFBOzRCQUFBLE9BQUFzRixTQUFBLENBQUF6SyxJQUFBO3dCQUFBO3NCQUFBO29CQUFBLEdBQUFvSyxRQUFBO2tCQUFBLENBRWI7a0JBQUEsaUJBQUFjLEdBQUEsRUFBQUMsR0FBQTtvQkFBQSxPQUFBaEIsS0FBQSxDQUFBL0osS0FBQSxPQUFBQyxTQUFBO2tCQUFBO2dCQUFBLElBQUMsV0FBUSxDQUFDO2tCQUFBLE9BQU1tSixlQUFlLENBQUM0QixLQUFLLENBQUMsQ0FBQztnQkFBQSxFQUFDO2NBQUE7Y0FBQTtnQkFBQSxPQUFBeEIsU0FBQSxDQUFBNUosSUFBQTtZQUFBO1VBQUE7UUFBQSxHQUFBb0osUUFBQTtNQUFBLENBQzFDO01BQUEsU0FBQWlDLGFBQUE7UUFBQSxPQUFBbEMsYUFBQSxDQUFBL0ksS0FBQSxPQUFBQyxTQUFBO01BQUE7TUFBQSxPQUFBZ0wsWUFBQTtJQUFBO0VBQUE7SUFBQWpQLEdBQUE7SUFBQW9CLEtBQUE7TUFBQSxJQUFBOE4sc0JBQUEsT0FBQTNOLGtCQUFBLDBCQUFBQyxZQUFBLFlBQUFDLElBQUEsQ0FFRCxTQUFBME4sVUFBQTtRQUFBLElBQUFDLE1BQUE7UUFBQSxJQUFBQyxVQUFBLEVBQUFDLEtBQUE7UUFBQSxPQUFBOU4sWUFBQSxZQUFBYyxJQUFBLFVBQUFpTixXQUFBQyxVQUFBO1VBQUE7WUFBQSxRQUFBQSxVQUFBLENBQUEvTSxJQUFBLEdBQUErTSxVQUFBLENBQUE5TSxJQUFBO2NBQUE7Z0JBQUE4TSxVQUFBLENBQUE5TSxJQUFBO2dCQUFBLE9BTVUsQ0FBQyxJQUFJLENBQUMrRCxlQUFlLEdBQUcsSUFBQWdKLDBCQUFjLEVBQUMsQ0FBQyxFQUFFQyxPQUFPO2NBQUE7Z0JBRW5ETCxVQUFVLEdBQUc5TyxlQUFlO2dCQUVoQyxJQUFJLENBQUNVLGlCQUFpQixDQUFDeUIsSUFBSSxDQUFDb0MsNEJBQWdCLENBQUM2SyxVQUFVLENBQUM7Y0FBQztnQkFBQSxNQUVsRE4sVUFBVSxHQUFHLENBQUM7a0JBQUFHLFVBQUEsQ0FBQTlNLElBQUE7a0JBQUE7Z0JBQUE7Z0JBQ25CMk0sVUFBVSxFQUFFO2dCQUVOQyxLQUFLLEdBQUdNLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUM7Z0JBQUFMLFVBQUEsQ0FBQS9NLElBQUE7Z0JBQUErTSxVQUFBLENBQUE5TSxJQUFBO2dCQUFBLE9BSWhCLElBQUksQ0FBQ3VNLFlBQVksQ0FBQyxDQUFDO2NBQUE7Z0JBQUFPLFVBQUEsQ0FBQTlNLElBQUE7Z0JBQUE7Y0FBQTtnQkFBQThNLFVBQUEsQ0FBQS9NLElBQUE7Z0JBQUErTSxVQUFBLENBQUF6RyxFQUFBLEdBQUF5RyxVQUFBO2dCQUV6QmxLLE9BQU8sQ0FBQ25DLEtBQUssQ0FBQXFNLFVBQUEsQ0FBQXpHLEVBQUksQ0FBQztjQUFDO2dCQUFBLE1BSWpCLElBQUksQ0FBQzlILGlCQUFpQixDQUFDK0YsUUFBUSxDQUFDLENBQUMsS0FBS2xDLDRCQUFnQixDQUFDbUMsS0FBSztrQkFBQXVJLFVBQUEsQ0FBQTlNLElBQUE7a0JBQUE7Z0JBQUE7Z0JBQUEsT0FBQThNLFVBQUEsQ0FBQW5NLE1BQUE7Y0FBQTtnQkFLaEU7Z0JBQ0E7Z0JBQ0EsSUFBSSxJQUFJLENBQUNwQyxpQkFBaUIsQ0FBQytGLFFBQVEsQ0FBQyxDQUFDLEtBQUtsQyw0QkFBZ0IsQ0FBQzZLLFVBQVUsRUFBRTtrQkFDckUsSUFBSSxDQUFDMU8saUJBQWlCLENBQUN5QixJQUFJLENBQUNvQyw0QkFBZ0IsQ0FBQzZLLFVBQVUsQ0FBQztnQkFDMUQ7O2dCQUVBO2dCQUNBO2dCQUNBO2dCQUFBLE1BQ0ksS0FBSyxHQUFHQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEdBQUdQLEtBQUs7a0JBQUFFLFVBQUEsQ0FBQTlNLElBQUE7a0JBQUE7Z0JBQUE7Z0JBQzVCMk0sVUFBVSxHQUFHOU8sZUFBZTtnQkFBQ2lQLFVBQUEsQ0FBQTlNLElBQUE7Z0JBQUE7Y0FBQTtnQkFBQSxNQUNwQjJNLFVBQVUsR0FBRyxDQUFDO2tCQUFBRyxVQUFBLENBQUE5TSxJQUFBO2tCQUFBO2dCQUFBO2dCQUFBOE0sVUFBQSxDQUFBOU0sSUFBQTtnQkFBQSxPQUVqQixJQUFJMkYsT0FBTyxDQUFDLFVBQUFDLENBQUM7a0JBQUEsT0FBSUMsVUFBVSxDQUFDRCxDQUFDLEVBQUU4RyxNQUFJLENBQUNVLGFBQWEsQ0FBQyxDQUFDLENBQUM7Z0JBQUEsRUFBQztjQUFBO2dCQUFBTixVQUFBLENBQUE5TSxJQUFBO2dCQUFBO2NBQUE7Z0JBSS9EO2dCQUNBO2dCQUNBLElBQUksQ0FBQ3pCLGlCQUFpQixDQUFDeUIsSUFBSSxDQUFDb0MsNEJBQWdCLENBQUNvRSxlQUFlLENBQUM7Y0FBQztnQkFBQXNHLFVBQUEsQ0FBQTlNLElBQUE7Z0JBQUE7Y0FBQTtjQUFBO2dCQUFBLE9BQUE4TSxVQUFBLENBQUE1TCxJQUFBO1lBQUE7VUFBQTtRQUFBLEdBQUF1TCxTQUFBO01BQUEsQ0FJakU7TUFBQSxTQUFBdEksc0JBQUE7UUFBQSxPQUFBcUksc0JBQUEsQ0FBQWxMLEtBQUEsT0FBQUMsU0FBQTtNQUFBO01BQUEsT0FBQTRDLHFCQUFBO0lBQUEsSUFFRDtFQUFBO0lBQUE3RyxHQUFBO0lBQUFvQixLQUFBLEVBQ0EsU0FBQTBPLGNBQUEsRUFBd0I7TUFDdEIsT0FBT0MsSUFBSSxDQUFDQyxLQUFLLENBQUMsSUFBSSxHQUFHRCxJQUFJLENBQUNFLE1BQU0sQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDO0lBQ2pEO0VBQUM7RUFBQSxPQUFBdkwsbUJBQUE7QUFBQTtBQUFBd0wsT0FBQSxDQUFBeEwsbUJBQUEsR0FBQUEsbUJBQUEiLCJpZ25vcmVMaXN0IjpbXX0=